
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>SMatrixArray</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'reference/api/_autosummary/abtem.prism.s_matrix.SMatrixArray';</script>
    <link rel="icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="utils" href="abtem.prism.utils.html" />
    <link rel="prev" title="SMatrix" href="abtem.prism.s_matrix.SMatrix.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/logo.png" class="logo__image only-light" alt=" - Home"/>
    <script>document.write(`<img src="../../../_static/logo.png" class="logo__image only-dark" alt=" - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Get started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/basics.html">Basic examples</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../user_guide/walkthrough/walkthrough.html">Walkthrough</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/walkthrough/atomic_models.html">Atomic models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/walkthrough/potentials.html">Potentials</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/walkthrough/wave_functions.html">Wave functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/walkthrough/multislice.html">Multislice simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/walkthrough/contrast_transfer_function.html">Contrast transfer function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/walkthrough/scan_and_detect.html">Scan and detect</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/walkthrough/frozen_phonons.html">Frozen phonons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/walkthrough/parallelization.html">Parallelization</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../user_guide/appendix/appendix.html">Appendix</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../user_guide/appendix/conventions.html">Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../user_guide/appendix/multislice_derivation.html">Deriving the Multislice Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../user_guide/appendix/antialiasing.html">Sampling and antialiasing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../user_guide/appendix/convergence.html">Convergence</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../user_guide/tutorials/tutorials.html">Advanced tutorials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/tutorials/advanced_atomic_models.html">Advanced atomic models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/tutorials/orthogonal_cells.html">Orthogonal periodic supercells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/tutorials/partial_coherence.html">Partial coherence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/tutorials/structured_illumination.html">Structured illumination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/tutorials/charge_density.html"><em>ab initio</em> potentials with GPAW</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/tutorials/blochwave.html">Bloch-wave simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/tutorials/real_space.html">Multislice using the real space algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/tutorials/prism.html">PRISM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/tutorials/core_loss.html">Core-loss</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../user_guide/examples/examples.html">Example gallery</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/examples/notebooks/cbed_quickstart.html">CBED quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/examples/notebooks/hrtem_quickstart.html">HRTEM quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/examples/notebooks/stem_quickstart.html">STEM quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/examples/notebooks/prism_quickstart.html">PRISM quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/examples/notebooks/saed_quickstart.html">SAED quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/examples/notebooks/ped_quickstart.html">PED quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/examples/notebooks/blochwave_quickstart.html">Bloch wave quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/examples/notebooks/pacbed_quickstart.html">PACBED quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../user_guide/examples/notebooks/interactions.html">Interactive visualizations</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../user_guide/bibliography.html">Bibliography</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../api.html">API</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.antialias.html">antialias</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.antialias.antialias_aperture.html">antialias_aperture</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.antialias.AntialiasAperture.html">AntialiasAperture</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.array.html">array</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.array.concatenate.html">concatenate</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.array.from_zarr.html">from_zarr</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.array.moveaxis.html">moveaxis</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.array.multi_output_blockwise.html">multi_output_blockwise</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.array.stack.html">stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.array.swapaxes.html">swapaxes</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.array.validate_axis_metadata.html">validate_axis_metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.array.validate_lazy.html">validate_lazy</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.array.ArrayObject.html">ArrayObject</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.array.ComputableList.html">ComputableList</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.atoms.html">atoms</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.atoms_in_cell.html">atoms_in_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.best_orthogonal_cell.html">best_orthogonal_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.cut_cell.html">cut_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.decompose_affine_transform.html">decompose_affine_transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.euler_sequence.html">euler_sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.euler_to_rotation.html">euler_to_rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.flip_atoms.html">flip_atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.is_cell_hexagonal.html">is_cell_hexagonal</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.is_cell_orthogonal.html">is_cell_orthogonal</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.is_cell_valid.html">is_cell_valid</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.merge_close_atoms.html">merge_close_atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.orthogonalize_cell.html">orthogonalize_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.pad_atoms.html">pad_atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.plane_to_axes.html">plane_to_axes</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.pretty_print_transform.html">pretty_print_transform</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.rotate_atoms.html">rotate_atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.rotate_atoms_to_plane.html">rotate_atoms_to_plane</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.rotation_matrix_from_plane.html">rotation_matrix_from_plane</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.rotation_matrix_to_euler.html">rotation_matrix_to_euler</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.shrink_cell.html">shrink_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.standardize_cell.html">standardize_cell</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.atoms.wrap_with_tolerance.html">wrap_with_tolerance</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.waves.html">waves</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.waves.reduce_ensemble.html">reduce_ensemble</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.waves.BaseWaves.html">BaseWaves</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.waves.PlaneWave.html">PlaneWave</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.waves.Probe.html">Probe</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.waves.Waves.html">Waves</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.waves.WavesBuilder.html">WavesBuilder</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.scan.html">scan</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.scan.validate_coordinate.html">validate_coordinate</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.scan.validate_scan.html">validate_scan</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.scan.BaseScan.html">BaseScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.scan.CustomScan.html">CustomScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.scan.GridScan.html">GridScan</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.scan.LineScan.html">LineScan</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.detectors.html">detectors</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.detectors.validate_detectors.html">validate_detectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.detectors.AnnularDetector.html">AnnularDetector</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.detectors.BaseDetector.html">BaseDetector</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.detectors.FlexibleAnnularDetector.html">FlexibleAnnularDetector</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.detectors.PixelatedDetector.html">PixelatedDetector</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.detectors.SegmentedDetector.html">SegmentedDetector</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.detectors.WavesDetector.html">WavesDetector</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.measurements.html">measurements</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.measurements.calculate_max_reciprocal_space_vector.html">calculate_max_reciprocal_space_vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.measurements.integrate_disc.html">integrate_disc</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.measurements.periodic_crop.html">periodic_crop</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.measurements.reciprocal_lattice_vector_lengths.html">reciprocal_lattice_vector_lengths</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.measurements.BaseMeasurements.html">BaseMeasurements</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.measurements.DiffractionPatterns.html">DiffractionPatterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.measurements.Images.html">Images</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.measurements.IndexedDiffractionPatterns.html">IndexedDiffractionPatterns</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.measurements.MeasurementsEnsemble.html">MeasurementsEnsemble</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.measurements.PolarMeasurements.html">PolarMeasurements</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.measurements.RealSpaceLineProfiles.html">RealSpaceLineProfiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.measurements.ReciprocalSpaceLineProfiles.html">ReciprocalSpaceLineProfiles</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.transfer.html">transfer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.cartesian2polar.html">cartesian2polar</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.hard_aperture.html">hard_aperture</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.nyquist_sampling.html">nyquist_sampling</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.point_resolution.html">point_resolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.polar2cartesian.html">polar2cartesian</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.scherzer_defocus.html">scherzer_defocus</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.soft_aperture.html">soft_aperture</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.symbol_to_tex_symbol.html">symbol_to_tex_symbol</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.Aberrations.html">Aberrations</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.AnnularAperture.html">AnnularAperture</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.Aperture.html">Aperture</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.BaseAperture.html">BaseAperture</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.BaseTransferFunction.html">BaseTransferFunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.Bullseye.html">Bullseye</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.CTF.html">CTF</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.RadialPhasePlate.html">RadialPhasePlate</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.SpatialEnvelope.html">SpatialEnvelope</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.TemporalEnvelope.html">TemporalEnvelope</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.Vortex.html">Vortex</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transfer.Zernike.html">Zernike</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.transform.html">transform</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.transform.join_tuples.html">join_tuples</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transform.ArrayObjectTransform.html">ArrayObjectTransform</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transform.EmptyTransform.html">EmptyTransform</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transform.EnsembleTransform.html">EnsembleTransform</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transform.ReciprocalSpaceMultiplication.html">ReciprocalSpaceMultiplication</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transform.TransformFromFunc.html">TransformFromFunc</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transform.WavesToMeasurementTransform.html">WavesToMeasurementTransform</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transform.WavesToWavesTransform.html">WavesToWavesTransform</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.transform.WavesTransform.html">WavesTransform</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.parametrizations.html">parametrizations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.parametrizations.validate_parameters.html">validate_parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.parametrizations.validate_parametrization.html">validate_parametrization</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.parametrizations.validate_sigmas.html">validate_sigmas</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.parametrizations.EwaldParametrization.html">EwaldParametrization</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.parametrizations.KirklandParametrization.html">KirklandParametrization</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.parametrizations.LobatoParametrization.html">LobatoParametrization</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.parametrizations.Parametrization.html">Parametrization</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.parametrizations.PengParametrization.html">PengParametrization</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="abtem.parametrizations.functions.html">functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="abtem.parametrizations.functions.ewald.html">ewald</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.parametrizations.functions.kirkland.html">kirkland</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.parametrizations.functions.lobato.html">lobato</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.parametrizations.functions.peng.html">peng</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.integrals.html">integrals</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.correction_projected_scattering_factors.html">correction_projected_scattering_factors</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.cutoff_taper.html">cutoff_taper</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.gaussian_projected_scattering_factors.html">gaussian_projected_scattering_factors</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.gaussian_projection_weights.html">gaussian_projection_weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.interpolate_radial_functions.html">interpolate_radial_functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.optimize_cutoff.html">optimize_cutoff</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.sinc.html">sinc</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.superpose_deltas.html">superpose_deltas</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.FieldIntegrator.html">FieldIntegrator</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.GaussianProjectionIntegrals.html">GaussianProjectionIntegrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.ProjectionIntegralTable.html">ProjectionIntegralTable</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.QuadratureProjectionIntegrals.html">QuadratureProjectionIntegrals</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.integrals.ScatteringFactorProjectionIntegrals.html">ScatteringFactorProjectionIntegrals</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.inelastic.phonons.html">phonons</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.inelastic.phonons.all_keys_are_ints.html">all_keys_are_ints</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.inelastic.phonons.atom_property_dict_to_atom_property_array.html">atom_property_dict_to_atom_property_array</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.inelastic.phonons.ensure_all_values_are_tuples.html">ensure_all_values_are_tuples</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.inelastic.phonons.validate_per_atom_property.html">validate_per_atom_property</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.inelastic.phonons.validate_seeds.html">validate_seeds</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.inelastic.phonons.validate_sigmas.html">validate_sigmas</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.inelastic.phonons.AtomsEnsemble.html">AtomsEnsemble</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.inelastic.phonons.BaseFrozenPhonons.html">BaseFrozenPhonons</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.inelastic.phonons.DummyFrozenPhonons.html">DummyFrozenPhonons</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.inelastic.phonons.FrozenPhonons.html">FrozenPhonons</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.distributions.html">distributions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.distributions.from_values.html">from_values</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.distributions.gaussian.html">gaussian</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.distributions.tuple_range_except.html">tuple_range_except</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.distributions.uniform.html">uniform</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.distributions.validate_distribution.html">validate_distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.distributions.BaseDistribution.html">BaseDistribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.distributions.DistributionFromValues.html">DistributionFromValues</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.distributions.EnsembleFromDistributions.html">EnsembleFromDistributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.distributions.MultidimensionalDistribution.html">MultidimensionalDistribution</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.potentials.html">potentials</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="abtem.potentials.charge_density.html">charge_density</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.charge_density.add_point_charges_fourier.html">add_point_charges_fourier</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.charge_density.curl_fourier.html">curl_fourier</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.charge_density.integrate_gradient_fourier.html">integrate_gradient_fourier</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.charge_density.ChargeDensityPotential.html">ChargeDensityPotential</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="abtem.potentials.gpaw.html">gpaw</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.gpaw.get_core_correction_interpolators.html">get_core_correction_interpolators</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.gpaw.integrate_slice.html">integrate_slice</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.gpaw.GPAWParametrization.html">GPAWParametrization</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.gpaw.GPAWPotential.html">GPAWPotential</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="abtem.potentials.iam.html">iam</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.iam.validate_potential.html">validate_potential</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.iam.BaseField.html">BaseField</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.iam.BasePotential.html">BasePotential</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.iam.CrystalPotential.html">CrystalPotential</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.iam.FieldArray.html">FieldArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.iam.Potential.html">Potential</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.iam.PotentialArray.html">PotentialArray</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.potentials.iam.TransmissionFunction.html">TransmissionFunction</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.tilt.html">tilt</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.tilt.precession_tilts.html">precession_tilts</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.tilt.validate_tilt.html">validate_tilt</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.tilt.AxisAlignedBeamTilt.html">AxisAlignedBeamTilt</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.tilt.BaseBeamTilt.html">BaseBeamTilt</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.tilt.BeamTilt.html">BeamTilt</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.tilt.BeamTilt2D.html">BeamTilt2D</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.visualize.html">visualize</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="abtem.visualize.artists.html">artists</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.default_cbar_scalar_formatter.html">default_cbar_scalar_formatter</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.get_extent.html">get_extent</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.validate_cmap.html">validate_cmap</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.AreaIndicator.html">AreaIndicator</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.Artist.html">Artist</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.Artist1D.html">Artist1D</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.Artist2D.html">Artist2D</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.CircleAnnotations.html">CircleAnnotations</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.DomainColoringArtist.html">DomainColoringArtist</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.ImageArtist.html">ImageArtist</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.LinesArtist.html">LinesArtist</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.OverlayImshowArtist.html">OverlayImshowArtist</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.ScaleBar.html">ScaleBar</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.ScaledCircleCollection.html">ScaledCircleCollection</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.artists.ScatterArtist.html">ScatterArtist</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="abtem.visualize.axes_grid.html">axes_grid</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.axes_grid.AxesCollection.html">AxesCollection</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.axes_grid.AxesGrid.html">AxesGrid</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="abtem.visualize.visualizations.html">visualizations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.visualizations.convert_complex.html">convert_complex</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.visualizations.discrete_cmap.html">discrete_cmap</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.visualizations.show_atoms.html">show_atoms</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.visualizations.Visualization.html">Visualization</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="abtem.visualize.widgets.html">widgets</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.widgets.make_toggle_hkl_button.html">make_toggle_hkl_button</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.widgets.slider_from_axes_metadata.html">slider_from_axes_metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.widgets.BaseGUI.html">BaseGUI</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.widgets.ImageGUI.html">ImageGUI</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.widgets.LinesGUI.html">LinesGUI</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.visualize.widgets.ScatterGUI.html">ScatterGUI</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="abtem.multislice.html">multislice</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="abtem.multislice.allocate_measurement.html">allocate_measurement</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.multislice.allocate_multislice_measurements.html">allocate_multislice_measurements</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.multislice.conventional_multislice_step.html">conventional_multislice_step</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.multislice.is_waves_base_measurements_or_list.html">is_waves_base_measurements_or_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.multislice.multislice_and_detect.html">multislice_and_detect</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.multislice.transition_potential_multislice_and_detect.html">transition_potential_multislice_and_detect</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.multislice.FresnelPropagator.html">FresnelPropagator</a></li>
<li class="toctree-l3"><a class="reference internal" href="abtem.multislice.MultisliceTransform.html">MultisliceTransform</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="abtem.prism.html">prism</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active has-children"><a class="reference internal" href="abtem.prism.s_matrix.html">s_matrix</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="abtem.prism.s_matrix.BaseSMatrix.html">BaseSMatrix</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.prism.s_matrix.SMatrix.html">SMatrix</a></li>
<li class="toctree-l4 current active"><a class="current reference internal" href="#">SMatrixArray</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="abtem.prism.utils.html">utils</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="abtem.prism.utils.batch_crop_2d.html">batch_crop_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.prism.utils.minimum_crop.html">minimum_crop</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.prism.utils.plane_waves.html">plane_waves</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.prism.utils.prism_coefficients.html">prism_coefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.prism.utils.prism_wave_vectors.html">prism_wave_vectors</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.prism.utils.wrapped_crop_2d.html">wrapped_crop_2d</a></li>
<li class="toctree-l4"><a class="reference internal" href="abtem.prism.utils.wrapped_slices.html">wrapped_slices</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../config.html">Configuration</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">abTEM</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../abtem/contact.html">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../abtem/contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../abtem/cite.html">Cite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../abtem/changelog.html">Changelog</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Freference/api/_autosummary/abtem.prism.s_matrix.SMatrixArray.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/reference/api/_autosummary/abtem.prism.s_matrix.SMatrixArray.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>SMatrixArray</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray"><code class="docutils literal notranslate"><span class="pre">SMatrixArray</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.__init__"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.__init__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.accelerator"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.accelerator</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.angular_sampling"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.angular_sampling</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.antialias_cutoff_gpts"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.antialias_cutoff_gpts</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.antialias_valid_gpts"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.antialias_valid_gpts</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.apply_func"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.apply_func()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.apply_transform"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.apply_transform()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.array"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.array</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.axes_metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.axes_metadata</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.base_axes_metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.base_axes_metadata</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.base_dims"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.base_dims</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.base_shape"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.base_shape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.compute"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.compute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.copy"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.copy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.copy_to_device"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.copy_to_device()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.cutoff_angles"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.cutoff_angles</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.cutoff_frequencies"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.cutoff_frequencies</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.device"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.device</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.dtype"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.dtype</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.dummy_probes"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.dummy_probes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.energy"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.energy</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_axes_metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.ensemble_axes_metadata</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_blocks"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.ensemble_blocks()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_dims"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.ensemble_dims</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_shape"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.ensemble_shape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.ensure_lazy"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.ensure_lazy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.expand_dims"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.expand_dims()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.extent"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.extent</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.from_array_and_metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.from_array_and_metadata()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.from_zarr"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.from_zarr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.full_cutoff_angles"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.full_cutoff_angles</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.generate_blocks"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.generate_blocks()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.get_items"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.get_items()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.gpts"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.gpts</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.grid"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.grid</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.interpolation"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.interpolation</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.is_complex"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.is_complex</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.is_lazy"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.is_lazy</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.match_grid"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.match_grid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.max"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.max()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.mean"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.mean()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.metadata</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.min"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.min()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.multislice"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.multislice()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.no_base_chunks"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.no_base_chunks()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.periodic"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.periodic</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.rechunk"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.rechunk()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.reciprocal_space_axes_metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.reciprocal_space_axes_metadata</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.reciprocal_space_sampling"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.reciprocal_space_sampling</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.rectangle_cutoff_angles"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.rectangle_cutoff_angles</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.reduce"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.reduce()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.sampling"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.sampling</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.scan"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.scan()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.semiangle_cutoff"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.semiangle_cutoff</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.set_ensemble_axes_metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.set_ensemble_axes_metadata()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.shape"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.shape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.squeeze"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.squeeze()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.std"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.std()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.storage_device"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.storage_device</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.sum"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.sum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.to_cpu"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.to_cpu()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.to_data_array"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.to_data_array()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.to_gpu"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.to_gpu()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.to_hyperspy"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.to_hyperspy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.to_tiff"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.to_tiff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.to_zarr"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.to_zarr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.wave_vectors"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.wave_vectors</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.wavelength"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.wavelength</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.waves"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.waves</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.window_extent"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.window_extent</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.window_gpts"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.window_gpts</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.window_offset"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.window_offset</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="smatrixarray">
<h1>SMatrixArray<a class="headerlink" href="#smatrixarray" title="Link to this heading">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">abtem.prism.s_matrix.</span></span><span class="sig-name descname"><span class="pre">SMatrixArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semiangle_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_gpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_axes_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abtem.prism.s_matrix.BaseSMatrix.html#abtem.prism.s_matrix.BaseSMatrix" title="abtem.prism.s_matrix.BaseSMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSMatrix</span></code></a>, <a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArrayObject</span></code></a></p>
<p>A scattering matrix defined by a given array of dimension 3, where the first indexes
the probe plane waves and the latter two are the <cite>y</cite> and <cite>x</cite> scan directions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>np.ndarray</em>)  Array defining the scattering matrix. Must be 3D or higher, dimensions before
the last three dimensions should represent ensemble dimensions, the next
dimension indexes the plane waves and the last two dimensions represent the
spatial extent of the plane waves.</p></li>
<li><p><strong>wave_vectors</strong> (<em>np.ndarray</em>)  Array defining the wave vectors corresponding to each plane wave.
Must have shape Nx2, where N is equal to the number of plane waves.</p></li>
<li><p><strong>semiangle_cutoff</strong> (<em>float</em>)  The radial cutoff of the plane-wave expansion [mrad].</p></li>
<li><p><strong>energy</strong> (<em>float</em>)  Electron energy [eV].</p></li>
<li><p><strong>sampling</strong> (<em>one</em><em> or </em><em>two float</em><em>, </em><em>optional</em>)  Lateral sampling of wave functions []. Provide only if potential is not given.
Will be ignored if gpts is also provided.</p></li>
<li><p><strong>extent</strong> (<em>one</em><em> or </em><em>two float</em><em>, </em><em>optional</em>)  Lateral extent of wave functions []. Provide only if potential is not given.</p></li>
<li><p><strong>interpolation</strong> (<em>one</em><em> or </em><em>two int</em><em>, </em><em>optional</em>)  Interpolation factor in the <cite>x</cite> and <cite>y</cite> directions
(default is 1, ie. no interpolation). If a single value is provided, assumed to
be the same for both directions.</p></li>
<li><p><strong>window_gpts</strong> (<em>tuple</em><em> of </em><em>int</em>)  The number of grid points describing the cropping window of the wave functions.</p></li>
<li><p><strong>window_offset</strong> (<em>tuple</em><em> of </em><em>int</em>)  The number of grid points from the origin the cropping windows of the wave
functions is displaced.</p></li>
<li><p><strong>periodic</strong> (<em>tuple</em><em> of </em><em>bool</em>)  Specifies whether the SMatrix should be assumed to be periodic along the x and
y-axis.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>)  The calculations will be carried out on this device (cpu or gpu).
Default is cpu. The default is determined by the user configuration.</p></li>
<li><p><strong>ensemble_axes_metadata</strong> (<em>list</em><em> of </em><em>AxesMetadata</em>)  Axis metadata for each ensemble axis. The axis metadata must be compatible with
the shape of the array.</p></li>
<li><p><strong>metadata</strong> (<em>dict</em>)  A dictionary defining wave function metadata. All items will be added to the
metadata of measurements derived from the waves.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semiangle_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_gpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_axes_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.__init__" title="abtem.prism.s_matrix.SMatrixArray.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(array,wave_vectors,semiangle_cutoff)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.apply_func" title="abtem.prism.s_matrix.SMatrixArray.apply_func"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_func</span></code></a>(func,**kwargs)</p></td>
<td><p>Apply a function to the array object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.apply_transform" title="abtem.prism.s_matrix.SMatrixArray.apply_transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_transform</span></code></a>(transform[,max_batch])</p></td>
<td><p>Transform the wave functions by a given transformation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.compute" title="abtem.prism.s_matrix.SMatrixArray.compute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute</span></code></a>([progress_bar,profiler,...])</p></td>
<td><p>Turn a lazy <a href="#id1"><span class="problematic" id="id2">*</span></a>ab*TEM object into its in-memory equivalent.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.copy" title="abtem.prism.s_matrix.SMatrixArray.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Make a copy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.copy_to_device" title="abtem.prism.s_matrix.SMatrixArray.copy_to_device"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_to_device</span></code></a>(device)</p></td>
<td><p>Copy SMatrixArray to specified device.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.dummy_probes" title="abtem.prism.s_matrix.SMatrixArray.dummy_probes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dummy_probes</span></code></a>([scan,ctf,plane,downsample])</p></td>
<td><p>A probe or an ensemble of probes equivalent reducing the SMatrix at a single position.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_blocks" title="abtem.prism.s_matrix.SMatrixArray.ensemble_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ensemble_blocks</span></code></a>([chunks])</p></td>
<td><p>Split the ensemble into an array of smaller ensembles.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.ensure_lazy" title="abtem.prism.s_matrix.SMatrixArray.ensure_lazy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ensure_lazy</span></code></a>([chunks])</p></td>
<td><p>Creates an equivalent lazy version of the array object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.expand_dims" title="abtem.prism.s_matrix.SMatrixArray.expand_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expand_dims</span></code></a>([axis,axis_metadata])</p></td>
<td><p>Expand the shape of the array object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.from_array_and_metadata" title="abtem.prism.s_matrix.SMatrixArray.from_array_and_metadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_array_and_metadata</span></code></a>(axes_metadata,metadata)</p></td>
<td><p>Creates array object from a given array and metadata.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.from_zarr" title="abtem.prism.s_matrix.SMatrixArray.from_zarr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_zarr</span></code></a>(url[,chunks])</p></td>
<td><p>Read wave functions from a hdf5 file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.generate_blocks" title="abtem.prism.s_matrix.SMatrixArray.generate_blocks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_blocks</span></code></a>([chunks])</p></td>
<td><p>Generate chunks of the ensemble.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_from_metadata</span></code>(name[,broadcastable])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.get_items" title="abtem.prism.s_matrix.SMatrixArray.get_items"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_items</span></code></a>(items[,keepdims])</p></td>
<td><p>Index the array and the corresponding axes metadata.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">lazy</span></code>([chunks])</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.match_grid" title="abtem.prism.s_matrix.SMatrixArray.match_grid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_grid</span></code></a>(other[,check_match])</p></td>
<td><p>Match the grid to another object with a Grid.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.max" title="abtem.prism.s_matrix.SMatrixArray.max"><code class="xref py py-obj docutils literal notranslate"><span class="pre">max</span></code></a>([axis,keepdims,split_every])</p></td>
<td><p>Maximum of array object over one or more axes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.mean" title="abtem.prism.s_matrix.SMatrixArray.mean"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean</span></code></a>([axis,keepdims,split_every])</p></td>
<td><p>Mean of array object over one or more axes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.min" title="abtem.prism.s_matrix.SMatrixArray.min"><code class="xref py py-obj docutils literal notranslate"><span class="pre">min</span></code></a>([axis,keepdims,split_every])</p></td>
<td><p>Minmimum of array object over one or more axes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.multislice" title="abtem.prism.s_matrix.SMatrixArray.multislice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multislice</span></code></a>([potential])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.no_base_chunks" title="abtem.prism.s_matrix.SMatrixArray.no_base_chunks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">no_base_chunks</span></code></a>()</p></td>
<td><p>Rechunk to remove chunks across the base dimensions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.rechunk" title="abtem.prism.s_matrix.SMatrixArray.rechunk"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rechunk</span></code></a>(chunks[,in_place])</p></td>
<td><p>Rechunk dask array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.reduce" title="abtem.prism.s_matrix.SMatrixArray.reduce"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reduce</span></code></a>([scan,ctf,detectors,...])</p></td>
<td><p>Scan the probe across the potential and record a measurement for each detector.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.scan" title="abtem.prism.s_matrix.SMatrixArray.scan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scan</span></code></a>([scan,detectors,ctf,...])</p></td>
<td><p>Reduce the SMatrix using coefficients calculated by a BaseScan and a CTF, to obtain the exit wave functions at given initial probe positions and aberrations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.set_ensemble_axes_metadata" title="abtem.prism.s_matrix.SMatrixArray.set_ensemble_axes_metadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_ensemble_axes_metadata</span></code></a>(axes_metadata,axis)</p></td>
<td><p>Sets the axes metadata of an ensemble axis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.squeeze" title="abtem.prism.s_matrix.SMatrixArray.squeeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">squeeze</span></code></a>([axis])</p></td>
<td><p>Remove axes of length one from array object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.std" title="abtem.prism.s_matrix.SMatrixArray.std"><code class="xref py py-obj docutils literal notranslate"><span class="pre">std</span></code></a>([axis,keepdims,split_every])</p></td>
<td><p>Standard deviation of array object over one or more axes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.sum" title="abtem.prism.s_matrix.SMatrixArray.sum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sum</span></code></a>([axis,keepdims,split_every])</p></td>
<td><p>Sum of array object over one or more axes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.to_cpu" title="abtem.prism.s_matrix.SMatrixArray.to_cpu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_cpu</span></code></a>()</p></td>
<td><p>Move the array to the host memory from an arbitrary source array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.to_data_array" title="abtem.prism.s_matrix.SMatrixArray.to_data_array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_data_array</span></code></a>()</p></td>
<td><p>Convert ArrayObject to a xarray DataArray.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.to_gpu" title="abtem.prism.s_matrix.SMatrixArray.to_gpu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_gpu</span></code></a>([device])</p></td>
<td><p>Move the array from the host memory to a gpu.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.to_hyperspy" title="abtem.prism.s_matrix.SMatrixArray.to_hyperspy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_hyperspy</span></code></a>([transpose])</p></td>
<td><p>Convert ArrayObject to a Hyperspy signal.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.to_tiff" title="abtem.prism.s_matrix.SMatrixArray.to_tiff"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_tiff</span></code></a>(filename,**kwargs)</p></td>
<td><p>Write data to a tiff file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.to_zarr" title="abtem.prism.s_matrix.SMatrixArray.to_zarr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_zarr</span></code></a>(url[,compute,overwrite])</p></td>
<td><p>Write data to a zarr file.</p></td>
</tr>
</tbody>
</table>
</div>
<p class="rubric">Attributes</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.accelerator" title="abtem.prism.s_matrix.SMatrixArray.accelerator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">accelerator</span></code></a></p></td>
<td><p>Accelerator object describing the acceleration energy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.angular_sampling" title="abtem.prism.s_matrix.SMatrixArray.angular_sampling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">angular_sampling</span></code></a></p></td>
<td><p>Reciprocal-space sampling in units of scattering angles [mrad].</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.antialias_cutoff_gpts" title="abtem.prism.s_matrix.SMatrixArray.antialias_cutoff_gpts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">antialias_cutoff_gpts</span></code></a></p></td>
<td><p>The number of grid points along the x and y direction in the simulation grid at the antialiasing cutoff scattering angle.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.antialias_valid_gpts" title="abtem.prism.s_matrix.SMatrixArray.antialias_valid_gpts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">antialias_valid_gpts</span></code></a></p></td>
<td><p>The number of grid points along the x and y direction in the simulation grid for the largest rectangle that fits within antialiasing cutoff scattering angle.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.array" title="abtem.prism.s_matrix.SMatrixArray.array"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></p></td>
<td><p>Underlying array describing the array object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.axes_metadata" title="abtem.prism.s_matrix.SMatrixArray.axes_metadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">axes_metadata</span></code></a></p></td>
<td><p>List of AxisMetadata.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.base_axes_metadata" title="abtem.prism.s_matrix.SMatrixArray.base_axes_metadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">base_axes_metadata</span></code></a></p></td>
<td><p>List of AxisMetadata for the base axes in real space.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.base_dims" title="abtem.prism.s_matrix.SMatrixArray.base_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">base_dims</span></code></a></p></td>
<td><p>Number of base dimensions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.base_shape" title="abtem.prism.s_matrix.SMatrixArray.base_shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">base_shape</span></code></a></p></td>
<td><p>Shape of the base axes of the underlying array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.cutoff_angles" title="abtem.prism.s_matrix.SMatrixArray.cutoff_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cutoff_angles</span></code></a></p></td>
<td><p>Scattering angles at the antialias cutoff [mrad].</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.cutoff_frequencies" title="abtem.prism.s_matrix.SMatrixArray.cutoff_frequencies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cutoff_frequencies</span></code></a></p></td>
<td><p>Spatial frequencies at the antialias cutoff [1/].</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.device" title="abtem.prism.s_matrix.SMatrixArray.device"><code class="xref py py-obj docutils literal notranslate"><span class="pre">device</span></code></a></p></td>
<td><p>The device on which the SMatrixArray is reduced.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.dtype" title="abtem.prism.s_matrix.SMatrixArray.dtype"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></a></p></td>
<td><p>The datatype of waves.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.energy" title="abtem.prism.s_matrix.SMatrixArray.energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">energy</span></code></a></p></td>
<td><p>Electron acceleration energy in electron volts.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_axes_metadata" title="abtem.prism.s_matrix.SMatrixArray.ensemble_axes_metadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ensemble_axes_metadata</span></code></a></p></td>
<td><p>Axis metadata for each ensemble axis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_dims" title="abtem.prism.s_matrix.SMatrixArray.ensemble_dims"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ensemble_dims</span></code></a></p></td>
<td><p>Number of ensemble dimensions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_shape" title="abtem.prism.s_matrix.SMatrixArray.ensemble_shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ensemble_shape</span></code></a></p></td>
<td><p>Shape of the ensemble axes of the underlying array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.extent" title="abtem.prism.s_matrix.SMatrixArray.extent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extent</span></code></a></p></td>
<td><p>Extent of grid for each dimension in ngstrom.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.full_cutoff_angles" title="abtem.prism.s_matrix.SMatrixArray.full_cutoff_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">full_cutoff_angles</span></code></a></p></td>
<td><p>Scattering angles corresponding to the full wave function size [mrad].</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.gpts" title="abtem.prism.s_matrix.SMatrixArray.gpts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gpts</span></code></a></p></td>
<td><p>Number of grid points for each dimension.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.grid" title="abtem.prism.s_matrix.SMatrixArray.grid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grid</span></code></a></p></td>
<td><p>Simulation grid.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.interpolation" title="abtem.prism.s_matrix.SMatrixArray.interpolation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">interpolation</span></code></a></p></td>
<td><p>Interpolation factor in the <cite>x</cite> and <cite>y</cite> directions</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.is_complex" title="abtem.prism.s_matrix.SMatrixArray.is_complex"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_complex</span></code></a></p></td>
<td><p>True if array is complex.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.is_lazy" title="abtem.prism.s_matrix.SMatrixArray.is_lazy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_lazy</span></code></a></p></td>
<td><p>True if array is lazy.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.metadata" title="abtem.prism.s_matrix.SMatrixArray.metadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">metadata</span></code></a></p></td>
<td><p>Metadata stored as a dictionary.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.periodic" title="abtem.prism.s_matrix.SMatrixArray.periodic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">periodic</span></code></a></p></td>
<td><p>If True the SMatrix is assumed to be periodic along corresponding axis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.reciprocal_space_axes_metadata" title="abtem.prism.s_matrix.SMatrixArray.reciprocal_space_axes_metadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reciprocal_space_axes_metadata</span></code></a></p></td>
<td><p>List of AxisMetadata for base axes in reciprocal space.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.reciprocal_space_sampling" title="abtem.prism.s_matrix.SMatrixArray.reciprocal_space_sampling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reciprocal_space_sampling</span></code></a></p></td>
<td><p>Reciprocal-space sampling in reciprocal ngstrom.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.rectangle_cutoff_angles" title="abtem.prism.s_matrix.SMatrixArray.rectangle_cutoff_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rectangle_cutoff_angles</span></code></a></p></td>
<td><p>Scattering angles corresponding to the sides of the largest rectangle within the antialias cutoff [mrad].</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.sampling" title="abtem.prism.s_matrix.SMatrixArray.sampling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sampling</span></code></a></p></td>
<td><p>Grid sampling for each dimension in ngstrom per grid point.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.semiangle_cutoff" title="abtem.prism.s_matrix.SMatrixArray.semiangle_cutoff"><code class="xref py py-obj docutils literal notranslate"><span class="pre">semiangle_cutoff</span></code></a></p></td>
<td><p>The cutoff semiangle of the plane wave expansion.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.shape" title="abtem.prism.s_matrix.SMatrixArray.shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></a></p></td>
<td><p>Shape of the underlying array.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.storage_device" title="abtem.prism.s_matrix.SMatrixArray.storage_device"><code class="xref py py-obj docutils literal notranslate"><span class="pre">storage_device</span></code></a></p></td>
<td><p>The device on which the SMatrixArray is stored.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.wave_vectors" title="abtem.prism.s_matrix.SMatrixArray.wave_vectors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wave_vectors</span></code></a></p></td>
<td><p>The wave vectors corresponding to each plane wave.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.wavelength" title="abtem.prism.s_matrix.SMatrixArray.wavelength"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavelength</span></code></a></p></td>
<td><p>Relativistic wavelength in ngstrom.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.waves" title="abtem.prism.s_matrix.SMatrixArray.waves"><code class="xref py py-obj docutils literal notranslate"><span class="pre">waves</span></code></a></p></td>
<td><p>The wave vectors describing each plane wave.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.window_extent" title="abtem.prism.s_matrix.SMatrixArray.window_extent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">window_extent</span></code></a></p></td>
<td><p>The cropping window extent of the waves.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.window_gpts" title="abtem.prism.s_matrix.SMatrixArray.window_gpts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">window_gpts</span></code></a></p></td>
<td><p>The number of grid points describing the cropping window of the wave functions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.window_offset" title="abtem.prism.s_matrix.SMatrixArray.window_offset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">window_offset</span></code></a></p></td>
<td><p>The number of grid points from the origin the cropping windows of the wave functions is displaced.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.accelerator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">accelerator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Accelerator</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.accelerator" title="Link to this definition">#</a></dt>
<dd><p>Accelerator object describing the acceleration energy.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.angular_sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">angular_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.angular_sampling" title="Link to this definition">#</a></dt>
<dd><p>Reciprocal-space sampling in units of scattering angles [mrad].</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.antialias_cutoff_gpts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">antialias_cutoff_gpts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.antialias_cutoff_gpts" title="Link to this definition">#</a></dt>
<dd><p>The number of grid points along the x and y direction in the simulation grid
at the antialiasing cutoff scattering angle.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.antialias_valid_gpts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">antialias_valid_gpts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.antialias_valid_gpts" title="Link to this definition">#</a></dt>
<dd><p>The number of grid points along the x and y direction in the simulation grid
for the largest rectangle that fits within antialiasing cutoff scattering
angle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.apply_func">
<span class="sig-name descname"><span class="pre">apply_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.apply_func" title="Link to this definition">#</a></dt>
<dd><p>Apply a function to the array object. The function must take an array as its
first argument, only the array is modified, the metadata is not changed. The
function is applied lazily if the array object is lazy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>)  Function to apply to the array object.</p></li>
<li><p><strong>kwargs</strong>  Additional keyword arguments passed to the function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>array_object</strong>  The array object with the function applied.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a> or subclass of <a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.apply_transform">
<span class="sig-name descname"><span class="pre">apply_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.apply_transform" title="Link to this definition">#</a></dt>
<dd><p>Transform the wave functions by a given transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transform</strong> (<a class="reference internal" href="abtem.transform.ArrayObjectTransform.html#abtem.transform.ArrayObjectTransform" title="abtem.transform.ArrayObjectTransform"><em>ArrayObjectTransform</em></a>)  The array object transformation to apply.</p></li>
<li><p><strong>max_batch</strong> (<em>int</em><em>, </em><em>optional</em>)  The number of wave functions in each chunk of the Dask array.
If auto (default), the batch size is automatically chosen based on the
abtem user configuration settings dask.chunk-size and
dask.chunk-size-gpu.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>transformed_array_object</strong>  The transformed array object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.array">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">array</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Array</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.array" title="Link to this definition">#</a></dt>
<dd><p>Underlying array describing the array object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.axes_metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">axes_metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">AxesMetadataList</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.axes_metadata" title="Link to this definition">#</a></dt>
<dd><p>List of AxisMetadata.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.base_axes_metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">base_axes_metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisMetadata</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.base_axes_metadata" title="Link to this definition">#</a></dt>
<dd><p>List of AxisMetadata for the base axes in real space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.base_dims">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">base_dims</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.base_dims" title="Link to this definition">#</a></dt>
<dd><p>Number of base dimensions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.base_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">base_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.base_shape" title="Link to this definition">#</a></dt>
<dd><p>Shape of the base axes of the underlying array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profiler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_profiler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.compute" title="Link to this definition">#</a></dt>
<dd><p>Turn a lazy <a href="#id3"><span class="problematic" id="id4">*</span></a>ab*TEM object into its in-memory equivalent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>progress_bar</strong> (<em>bool</em>)  Display a progress bar in the terminal or notebook during computation. The
progress bar is only displayed with a local scheduler.</p></li>
<li><p><strong>profiler</strong> (<em>bool</em>)  Return Profiler class used to profile Dasks execution at the task level.
Only execution with a local scheduler is profiled.</p></li>
<li><p><strong>resource_profiler</strong> (<em>bool</em>)  Return ResourceProfiler class used to profile Dasks execution at the
resource level.</p></li>
<li><p><strong>kwargs</strong>  Additional keyword arguments passed to <cite>dask.compute</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>]]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.copy" title="Link to this definition">#</a></dt>
<dd><p>Make a copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.copy_to_device">
<span class="sig-name descname"><span class="pre">copy_to_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray.copy_to_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.copy_to_device" title="Link to this definition">#</a></dt>
<dd><p>Copy SMatrixArray to specified device.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray" title="abtem.prism.s_matrix.SMatrixArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">SMatrixArray</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.cutoff_angles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cutoff_angles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.cutoff_angles" title="Link to this definition">#</a></dt>
<dd><p>Scattering angles at the antialias cutoff [mrad].</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.cutoff_frequencies">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cutoff_frequencies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.cutoff_frequencies" title="Link to this definition">#</a></dt>
<dd><p>Spatial frequencies at the antialias cutoff [1/].</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.device" title="Link to this definition">#</a></dt>
<dd><p>The device on which the SMatrixArray is reduced.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dtype</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dtype</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.dtype" title="Link to this definition">#</a></dt>
<dd><p>The datatype of waves.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.dummy_probes">
<span class="sig-name descname"><span class="pre">dummy_probes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'entrance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downsample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.dummy_probes" title="Link to this definition">#</a></dt>
<dd><p>A probe or an ensemble of probes equivalent reducing the SMatrix at a single
position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scan</strong> (<a class="reference internal" href="abtem.scan.BaseScan.html#abtem.scan.BaseScan" title="abtem.scan.BaseScan"><em>BaseScan</em></a>)</p></li>
<li><p><strong>ctf</strong> (<a class="reference internal" href="abtem.transfer.CTF.html#abtem.transfer.CTF" title="abtem.transfer.CTF"><em>CTF</em></a>)</p></li>
<li><p><strong>plane</strong> (<em>str</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>dummy_probes</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Probes</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.energy" title="Link to this definition">#</a></dt>
<dd><p>Electron acceleration energy in electron volts.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.ensemble_axes_metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ensemble_axes_metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisMetadata</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_axes_metadata" title="Link to this definition">#</a></dt>
<dd><p>Axis metadata for each ensemble axis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.ensemble_blocks">
<span class="sig-name descname"><span class="pre">ensemble_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_blocks" title="Link to this definition">#</a></dt>
<dd><p>Split the ensemble into an array of smaller ensembles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chunks</strong> (<em>iterable</em><em> of </em><em>tuples</em>)  Block sizes along each dimension.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.ensemble_dims">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ensemble_dims</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_dims" title="Link to this definition">#</a></dt>
<dd><p>Number of ensemble dimensions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.ensemble_shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ensemble_shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_shape" title="Link to this definition">#</a></dt>
<dd><p>Shape of the ensemble axes of the underlying array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.ensure_lazy">
<span class="sig-name descname"><span class="pre">ensure_lazy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.ensure_lazy" title="Link to this definition">#</a></dt>
<dd><p>Creates an equivalent lazy version of the array object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chunks</strong> (<em>int</em><em> or </em><em>tuple</em><em> or </em><em>str</em>)  How to chunk the array. See <cite>dask.array.from_array</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>lazy_array_object</strong>  Lazy version of the array object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a> or subclass of <a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.expand_dims">
<span class="sig-name descname"><span class="pre">expand_dims</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.expand_dims" title="Link to this definition">#</a></dt>
<dd><p>Expand the shape of the array object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em>)  Position in the expanded axes where the new axis (or axes) is placed.</p></li>
<li><p><strong>axis_metadata</strong> (<em>AxisMetadata</em><em> or </em><em>List</em><em> of </em><em>AxisMetadata</em><em>, </em><em>optional</em>)  The axis metadata describing the expanded axes. Default is UnknownAxis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>expanded</strong>  View of array object with the number of dimensions increased.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a> or subclass of <a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.extent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.extent" title="Link to this definition">#</a></dt>
<dd><p>Extent of grid for each dimension in ngstrom.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.from_array_and_metadata">
<span class="sig-name descname"><span class="pre">from_array_and_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes_metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray.from_array_and_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.from_array_and_metadata" title="Link to this definition">#</a></dt>
<dd><p>Creates array object from a given array and metadata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>ndarray</em>)  Array defining the array object.</p></li>
<li><p><strong>axes_metadata</strong> (<em>list</em><em> of </em><em>AxesMetadata</em>)  Axis metadata for each axis. The axis metadata must be compatible with the
shape of the array.</p></li>
<li><p><strong>metadata</strong>  A dictionary defining the metadata of the array object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>array_object</strong>  The array object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a> or subclass of <a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.from_zarr">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_zarr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.from_zarr" title="Link to this definition">#</a></dt>
<dd><p>Read wave functions from a hdf5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></span></p>
</dd>
</dl>
<dl class="simple">
<dt>url<span class="classifier">str</span></dt><dd><p>Location of the data, typically a path to a local file. A URL can also
include a protocol specifier like s3:// for remote data.</p>
</dd>
<dt>chunks<span class="classifier">tuple of ints or tuples of ints</span></dt><dd><p>Passed to dask.array.from_array(), allows setting the chunks on
initialisation, if the chunking scheme in the on-disc dataset is not optimal
for the calculations to follow.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.full_cutoff_angles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">full_cutoff_angles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.full_cutoff_angles" title="Link to this definition">#</a></dt>
<dd><p>Scattering angles corresponding to the full wave function size [mrad].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.generate_blocks">
<span class="sig-name descname"><span class="pre">generate_blocks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.generate_blocks" title="Link to this definition">#</a></dt>
<dd><p>Generate chunks of the ensemble.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chunks</strong> (<em>iterable</em><em> of </em><em>tuples</em>)  Block sizes along each dimension.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generator</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">slice</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">...</span></code>], <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>], <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code>]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.get_items">
<span class="sig-name descname"><span class="pre">get_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">items</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.get_items" title="Link to this definition">#</a></dt>
<dd><p>Index the array and the corresponding axes metadata. Only ensemble axes can
be indexed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>items</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>int</em><em> or </em><em>slice</em>)  The array is indexed according to this.</p></li>
<li><p><strong>keepdims</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, all ensemble axes are left in the result as dimensions with size
one. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>indexed_array</strong>  The indexed array object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a> or subclass of <a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.gpts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gpts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.gpts" title="Link to this definition">#</a></dt>
<dd><p>Number of grid points for each dimension.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.grid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Grid</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.grid" title="Link to this definition">#</a></dt>
<dd><p>Simulation grid.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.interpolation">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">interpolation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.interpolation" title="Link to this definition">#</a></dt>
<dd><p>Interpolation factor in the <cite>x</cite> and <cite>y</cite> directions</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.is_complex">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_complex</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.is_complex" title="Link to this definition">#</a></dt>
<dd><p>True if array is complex.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.is_lazy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_lazy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.is_lazy" title="Link to this definition">#</a></dt>
<dd><p>True if array is lazy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.match_grid">
<span class="sig-name descname"><span class="pre">match_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.match_grid" title="Link to this definition">#</a></dt>
<dd><p>Match the grid to another object with a Grid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.max">
<span class="sig-name descname"><span class="pre">max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_every</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.max" title="Link to this definition">#</a></dt>
<dd><p>Maximum of array object over one or more axes. Only ensemble axes can be
reduced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>)  Axis or axes along which a maxima are calculated. The default is to compute
the mean of the flattened array. If this is a tuple of ints, the maxima are
calculated over multiple axes. The indicated axes must be ensemble axes.</p></li>
<li><p><strong>keepdims</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, the reduced axes are left in the result as dimensions with size
one. Default is False.</p></li>
<li><p><strong>split_every</strong> (<em>int</em>)  Only used for lazy arrays. See <cite>dask.array.reductions</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>reduced_array</strong>  The reduced array object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a> or subclass of <a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.mean">
<span class="sig-name descname"><span class="pre">mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_every</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.mean" title="Link to this definition">#</a></dt>
<dd><p>Mean of array object over one or more axes. Only ensemble axes can be
reduced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>)  Axis or axes along which a means are calculated. The default is to compute
the mean of the flattened array. If this is a tuple of ints, the mean is
calculated over multiple axes. The indicated axes must be ensemble axes.</p></li>
<li><p><strong>keepdims</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, the reduced axes are left in the result as dimensions with size
one. Default is False.</p></li>
<li><p><strong>split_every</strong> (<em>int</em>)  Only used for lazy arrays. See <cite>dask.array.reductions</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>reduced_array</strong>  The reduced array object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a> or subclass of <a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">dict</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.metadata" title="Link to this definition">#</a></dt>
<dd><p>Metadata stored as a dictionary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.min">
<span class="sig-name descname"><span class="pre">min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_every</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.min" title="Link to this definition">#</a></dt>
<dd><p>Minmimum of array object over one or more axes. Only ensemble axes can be
reduced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>)  Axis or axes along which a minima are calculated. The default is to compute
the mean of the flattened array. If this is a tuple of ints, the minima are
calculated over multiple axes. The indicated axes must be ensemble axes.</p></li>
<li><p><strong>keepdims</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, the reduced axes are left in the result as dimensions with size
one. Default is False.</p></li>
<li><p><strong>split_every</strong> (<em>int</em>)  Only used for lazy arrays. See <cite>dask.array.reductions</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>reduced_array</strong>  The reduced array object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a> or subclass of <a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.multislice">
<span class="sig-name descname"><span class="pre">multislice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">potential</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray.multislice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.multislice" title="Link to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>potential</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="abtem.potentials.iam.BasePotential.html#abtem.potentials.iam.BasePotential" title="abtem.potentials.iam.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a></span>)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray" title="abtem.prism.s_matrix.SMatrixArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">SMatrixArray</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.no_base_chunks">
<span class="sig-name descname"><span class="pre">no_base_chunks</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.no_base_chunks" title="Link to this definition">#</a></dt>
<dd><p>Rechunk to remove chunks across the base dimensions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.periodic">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">periodic</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.periodic" title="Link to this definition">#</a></dt>
<dd><p>If True the SMatrix is assumed to be periodic along corresponding axis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.rechunk">
<span class="sig-name descname"><span class="pre">rechunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_place</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray.rechunk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.rechunk" title="Link to this definition">#</a></dt>
<dd><p>Rechunk dask array.</p>
<dl class="simple">
<dt>chunks<span class="classifier">int or tuple or str</span></dt><dd><p>How to rechunk the array. See <cite>dask.array.rechunk</cite>.</p>
</dd>
<dt>kwargs :</dt><dd><p>Additional keyword arguments passes to <cite>dask.array.rechunk</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.reciprocal_space_axes_metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reciprocal_space_axes_metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">AxisMetadata</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.reciprocal_space_axes_metadata" title="Link to this definition">#</a></dt>
<dd><p>List of AxisMetadata for base axes in reciprocal space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.reciprocal_space_sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reciprocal_space_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.reciprocal_space_sampling" title="Link to this definition">#</a></dt>
<dd><p>Reciprocal-space sampling in reciprocal ngstrom.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.rectangle_cutoff_angles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rectangle_cutoff_angles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.rectangle_cutoff_angles" title="Link to this definition">#</a></dt>
<dd><p>Scattering angles corresponding to the sides of the largest rectangle within
the antialias cutoff [mrad].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.reduce">
<span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray.reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.reduce" title="Link to this definition">#</a></dt>
<dd><p>Scan the probe across the potential and record a measurement for each detector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detectors</strong> (<em>list</em><em> of </em><em>Detector objects</em>)  The detectors recording the measurements.</p></li>
<li><p><strong>scan</strong> (<em>Scan object</em>)  Scan defining the positions of the probe wave functions.</p></li>
<li><p><strong>ctf</strong> (<em>CTF object</em><em>, </em><em>optional</em>)  The probe contrast transfer function.
Default is None (aperture is set by the planewave cutoff).</p></li>
<li><p><strong>max_batch_reduction</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>optional</em>)  Number of positions per reduction operation. A large number of positions
better utilize thread parallelization, but requires more memory and floating
point operations. If auto (default), the batch size is automatically
chosen based on the abtem user configuration settings dask.chunk-size and
dask.chunk-size-gpu.</p></li>
<li><p><strong>rechunk</strong> (<em>two int</em><em> or </em><em>str</em><em>, </em><em>optional</em>)  Partitioning of the scan. The scattering matrix will be reduced in similarly
partitioned chunks. Should be equal to or greater than the interpolation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="abtem.measurements.BaseMeasurements.html#abtem.measurements.BaseMeasurements" title="abtem.measurements.BaseMeasurements"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMeasurements</span></code></a>, <a class="reference internal" href="abtem.waves.Waves.html#abtem.waves.Waves" title="abtem.waves.Waves"><code class="xref py py-class docutils literal notranslate"><span class="pre">Waves</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="abtem.measurements.BaseMeasurements.html#abtem.measurements.BaseMeasurements" title="abtem.measurements.BaseMeasurements"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMeasurements</span></code></a>, <a class="reference internal" href="abtem.waves.Waves.html#abtem.waves.Waves" title="abtem.waves.Waves"><code class="xref py py-class docutils literal notranslate"><span class="pre">Waves</span></code></a>]]]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.sampling" title="Link to this definition">#</a></dt>
<dd><p>Grid sampling for each dimension in ngstrom per grid point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.scan">
<span class="sig-name descname"><span class="pre">scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rechunk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray.scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.scan" title="Link to this definition">#</a></dt>
<dd><p>Reduce the SMatrix using coefficients calculated by a BaseScan and a CTF, to
obtain the exit wave functions at given initial probe positions and aberrations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scan</strong> (<a class="reference internal" href="abtem.scan.BaseScan.html#abtem.scan.BaseScan" title="abtem.scan.BaseScan"><em>BaseScan</em></a>)  Positions of the probe wave functions. If not given, scans across the entire
potential at Nyquist sampling.</p></li>
<li><p><strong>detectors</strong> (<a class="reference internal" href="abtem.detectors.BaseDetector.html#abtem.detectors.BaseDetector" title="abtem.detectors.BaseDetector"><em>BaseDetector</em></a><em>, </em><em>list</em><em> of </em><a class="reference internal" href="abtem.detectors.BaseDetector.html#abtem.detectors.BaseDetector" title="abtem.detectors.BaseDetector"><em>BaseDetector</em></a><em>, </em><em>optional</em>)  A detector or a list of detectors defining how the wave functions should be
converted to measurements after running the multislice algorithm.
See abtem.measurements.detect for a list of implemented detectors.</p></li>
<li><p><strong>ctf</strong> (<a class="reference internal" href="abtem.transfer.CTF.html#abtem.transfer.CTF" title="abtem.transfer.CTF"><em>CTF</em></a>)  Contrast transfer function from used for calculating the expansion
coefficients in the reduction of the SMatrix.</p></li>
<li><p><strong>max_batch_reduction</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>optional</em>)  Number of positions per reduction operation. A large number of positions
better utilize thread parallelization, but requires more memory and floating
point operations. If auto (default), the batch size is automatically
chosen based on the abtem user configuration settings dask.chunk-size and
dask.chunk-size-gpu.</p></li>
<li><p><strong>rechunk</strong> (<em>str</em><em> or </em><em>tuple</em><em> of </em><em>int</em><em>, </em><em>optional</em>)  Parallel reduction of the SMatrix requires rechunking the Dask array from
chunking along the expansion axis to chunking over the spatial axes.
If given as a tuple of int of length the SMatrix is rechunked to have those
chunks. If auto (default) the chunks are taken to be identical to the
interpolation factor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>detected_waves</strong> (<em>BaseMeasurements or list of BaseMeasurement</em>)  The detected measurement (if detector(s) given).</p></li>
<li><p><strong>exit_waves</strong> (<em>Waves</em>)  Wave functions at the exit plane(s) of the potential
(if no detector(s) given).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.semiangle_cutoff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">semiangle_cutoff</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.semiangle_cutoff" title="Link to this definition">#</a></dt>
<dd><p>The cutoff semiangle of the plane wave expansion.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.set_ensemble_axes_metadata">
<span class="sig-name descname"><span class="pre">set_ensemble_axes_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes_metadata</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.set_ensemble_axes_metadata" title="Link to this definition">#</a></dt>
<dd><p>Sets the axes metadata of an ensemble axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axes_metadata</strong> (<em>AxisMetadata</em>)  The new axis metadata.</p></li>
<li><p><strong>axis</strong> (<em>int</em>)  The axis to set.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.shape" title="Link to this definition">#</a></dt>
<dd><p>Shape of the underlying array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.squeeze">
<span class="sig-name descname"><span class="pre">squeeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.squeeze" title="Link to this definition">#</a></dt>
<dd><p>Remove axes of length one from array object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>axis</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>)  Selects a subset of the entries of length one in the shape.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>squeezed</strong>  The input array object, but with all or a subset of the dimensions of length
1 removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a> or subclass of <a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.std">
<span class="sig-name descname"><span class="pre">std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_every</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.std" title="Link to this definition">#</a></dt>
<dd><p>Standard deviation of array object over one or more axes. Only ensemble axes
can be reduced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>)  Axis or axes along which a standard deviations are calculated. The default
is to compute the mean of the flattened array. If this is a tuple of ints,
the standard deviations are calculated over multiple axes.
The indicated axes must be ensemble axes.</p></li>
<li><p><strong>keepdims</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, the reduced axes are left in the result as dimensions with size
one. Default is False.</p></li>
<li><p><strong>split_every</strong> (<em>int</em>)  Only used for lazy arrays. See <cite>dask.array.reductions</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>reduced_array</strong>  The reduced array object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a> or subclass of <a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.storage_device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">storage_device</span></span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.storage_device" title="Link to this definition">#</a></dt>
<dd><p>The device on which the SMatrixArray is stored.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.sum">
<span class="sig-name descname"><span class="pre">sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keepdims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_every</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.sum" title="Link to this definition">#</a></dt>
<dd><p>Sum of array object over one or more axes. Only ensemble axes can be reduced.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>axis</strong> (<em>int</em><em> or </em><em>tuple</em><em> of </em><em>ints</em><em>, </em><em>optional</em>)  Axis or axes along which a sums are performed. The default is to compute the
mean of the flattened array. If this is a tuple of ints, the sum is
performed over multiple axes. The indicated axes must be ensemble axes.</p></li>
<li><p><strong>keepdims</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, the reduced axes are left in the result as dimensions with size
one. Default is False.</p></li>
<li><p><strong>split_every</strong> (<em>int</em>)  Only used for lazy arrays. See <cite>dask.array.reductions</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>reduced_array</strong>  The reduced array object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a> or subclass of <a class="reference internal" href="abtem.array.ArrayObject.html#abtem.array.ArrayObject" title="abtem.array.ArrayObject">ArrayObject</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.to_cpu">
<span class="sig-name descname"><span class="pre">to_cpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.to_cpu" title="Link to this definition">#</a></dt>
<dd><p>Move the array to the host memory from an arbitrary source array.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.to_data_array">
<span class="sig-name descname"><span class="pre">to_data_array</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.to_data_array" title="Link to this definition">#</a></dt>
<dd><p>Convert ArrayObject to a xarray DataArray. Requires xarray to be installed.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The converted xarray DataArray.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>xarray.DataArray</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ImportError</strong>  If xarray is not installed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.to_gpu">
<span class="sig-name descname"><span class="pre">to_gpu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gpu'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.to_gpu" title="Link to this definition">#</a></dt>
<dd><p>Move the array from the host memory to a gpu.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">Self</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.to_hyperspy">
<span class="sig-name descname"><span class="pre">to_hyperspy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.to_hyperspy" title="Link to this definition">#</a></dt>
<dd><p>Convert ArrayObject to a Hyperspy signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>transpose</strong> (<em>bool</em><em>, </em><em>optional</em>)  If True, transpose the base axes of the array before converting to a
Hyperspy signal. Default is True.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>signal</strong>  The converted Hyperspy signal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Hyperspy signal</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ImportError</strong>  If Hyperspy is not installed.</p></li>
<li><p><strong>RuntimeError</strong>  If the number of base dimensions is not 1 or 2.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method requires Hyperspy to be installed. You can find more information
about Hyperspy at <a class="reference external" href="https://hyperspy.org">https://hyperspy.org</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.to_tiff">
<span class="sig-name descname"><span class="pre">to_tiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.to_tiff" title="Link to this definition">#</a></dt>
<dd><p>Write data to a tiff file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>)  The filename of the file to write.</p></li>
<li><p><strong>kwargs</strong>  Keyword arguments passed to <cite>tifffile.imwrite</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.to_zarr">
<span class="sig-name descname"><span class="pre">to_zarr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.to_zarr" title="Link to this definition">#</a></dt>
<dd><p>Write data to a zarr file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>)  Location of the data, typically a path to a local file. A URL can also
include a protocol specifier like s3:// for remote data.</p></li>
<li><p><strong>compute</strong> (<em>bool</em>)  If true compute immediately; return dask.delayed.Delayed otherwise.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>)  If given array already exists, overwrite=False will cause an error, where
overwrite=True will replace the existing data.</p></li>
<li><p><strong>kwargs</strong>  Keyword arguments passed to <cite>dask.array.to_zarr</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.wave_vectors">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wave_vectors</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ndarray</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.wave_vectors" title="Link to this definition">#</a></dt>
<dd><p>The wave vectors corresponding to each plane wave.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.wavelength">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wavelength</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.wavelength" title="Link to this definition">#</a></dt>
<dd><p>Relativistic wavelength in ngstrom.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.waves">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">waves</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="abtem.waves.Waves.html#abtem.waves.Waves" title="abtem.waves.Waves"><span class="pre">Waves</span></a></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.waves" title="Link to this definition">#</a></dt>
<dd><p>The wave vectors describing each plane wave.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.window_extent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">window_extent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.window_extent" title="Link to this definition">#</a></dt>
<dd><p>The cropping window extent of the waves.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.window_gpts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">window_gpts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.window_gpts" title="Link to this definition">#</a></dt>
<dd><p>The number of grid points describing the cropping window of the wave
functions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.window_offset">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">window_offset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.window_offset" title="Link to this definition">#</a></dt>
<dd><p>The number of grid points from the origin the cropping windows of the wave
functions is displaced.</p>
</dd></dl>

</dd></dl>

</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./reference/api/_autosummary"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="abtem.prism.s_matrix.SMatrix.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">SMatrix</p>
      </div>
    </a>
    <a class="right-next"
       href="abtem.prism.utils.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">utils</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray"><code class="docutils literal notranslate"><span class="pre">SMatrixArray</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.__init__"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.__init__()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.accelerator"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.accelerator</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.angular_sampling"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.angular_sampling</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.antialias_cutoff_gpts"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.antialias_cutoff_gpts</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.antialias_valid_gpts"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.antialias_valid_gpts</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.apply_func"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.apply_func()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.apply_transform"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.apply_transform()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.array"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.array</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.axes_metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.axes_metadata</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.base_axes_metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.base_axes_metadata</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.base_dims"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.base_dims</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.base_shape"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.base_shape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.compute"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.compute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.copy"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.copy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.copy_to_device"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.copy_to_device()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.cutoff_angles"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.cutoff_angles</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.cutoff_frequencies"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.cutoff_frequencies</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.device"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.device</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.dtype"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.dtype</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.dummy_probes"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.dummy_probes()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.energy"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.energy</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_axes_metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.ensemble_axes_metadata</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_blocks"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.ensemble_blocks()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_dims"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.ensemble_dims</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_shape"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.ensemble_shape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.ensure_lazy"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.ensure_lazy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.expand_dims"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.expand_dims()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.extent"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.extent</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.from_array_and_metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.from_array_and_metadata()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.from_zarr"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.from_zarr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.full_cutoff_angles"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.full_cutoff_angles</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.generate_blocks"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.generate_blocks()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.get_items"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.get_items()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.gpts"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.gpts</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.grid"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.grid</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.interpolation"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.interpolation</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.is_complex"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.is_complex</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.is_lazy"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.is_lazy</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.match_grid"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.match_grid()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.max"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.max()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.mean"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.mean()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.metadata</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.min"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.min()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.multislice"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.multislice()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.no_base_chunks"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.no_base_chunks()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.periodic"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.periodic</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.rechunk"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.rechunk()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.reciprocal_space_axes_metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.reciprocal_space_axes_metadata</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.reciprocal_space_sampling"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.reciprocal_space_sampling</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.rectangle_cutoff_angles"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.rectangle_cutoff_angles</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.reduce"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.reduce()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.sampling"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.sampling</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.scan"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.scan()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.semiangle_cutoff"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.semiangle_cutoff</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.set_ensemble_axes_metadata"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.set_ensemble_axes_metadata()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.shape"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.shape</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.squeeze"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.squeeze()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.std"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.std()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.storage_device"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.storage_device</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.sum"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.sum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.to_cpu"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.to_cpu()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.to_data_array"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.to_data_array()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.to_gpu"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.to_gpu()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.to_hyperspy"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.to_hyperspy()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.to_tiff"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.to_tiff()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.to_zarr"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.to_zarr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.wave_vectors"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.wave_vectors</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.wavelength"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.wavelength</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.waves"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.waves</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.window_extent"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.window_extent</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.window_gpts"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.window_gpts</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#abtem.prism.s_matrix.SMatrixArray.window_offset"><code class="docutils literal notranslate"><span class="pre">SMatrixArray.window_offset</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By abTEM developers
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>