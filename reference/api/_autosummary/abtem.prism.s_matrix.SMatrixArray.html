
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>SMatrixArray</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="indexing" href="abtem.indexing.html" />
    <link rel="prev" title="SMatrix" href="abtem.prism.s_matrix.SMatrix.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Welcome!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Get started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../getting_started/overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../getting_started/install.html">
   Installation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../getting_started/basics.html">
   Basic examples
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  User guide
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../user_guide/walkthrough/walkthrough.html">
   Walkthrough
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/walkthrough/atomic_models.html">
     Atomic models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/walkthrough/potentials.html">
     Potentials
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/walkthrough/wave_functions.html">
     Wave functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/walkthrough/multislice.html">
     Multislice simulations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/walkthrough/contrast_transfer_function.html">
     Contrast transfer function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/walkthrough/scan_and_detect.html">
     Scan and detect
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/walkthrough/frozen_phonons.html">
     Frozen phonons
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/walkthrough/parallelization.html">
     Parallelization
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../../../user_guide/appendix/appendix.html">
     Appendix
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../user_guide/appendix/multislice_derivation.html">
       Deriving the Multislice Algorithm
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../../../user_guide/appendix/antialiasing.html">
       Sampling and antialiasing
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../user_guide/tutorials/tutorials.html">
   Advanced tutorials
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/tutorials/advanced_atomic_models.html">
     Advanced atomic models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/tutorials/partial_coherence.html">
     Partial coherence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/tutorials/charge_density.html">
     <em>
      ab initio
     </em>
     potentials with GPAW
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/tutorials/prism.html">
     PRISM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/tutorials/epie.html">
     Ptychography with ePIE
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/tutorials/visualizations.html">
     Visualizations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/tutorials/core_loss.html">
     Core-loss
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/tutorials/plasmons.html">
     Plasmons
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../../user_guide/examples/examples.html">
   Example gallery
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/examples/notebooks/cbed_quickstart.html">
     CBED quickstart
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/examples/notebooks/hrtem_quickstart.html">
     HRTEM quickstart
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/examples/notebooks/prism_quickstart.html">
     PRISM quickstart
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/examples/notebooks/stem_quickstart.html">
     STEM quickstart
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/examples/notebooks/4d-stem_quickstart.html">
     4D-STEM quickstart
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/examples/notebooks/saed_quickstart.html">
     SAED quickstart
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../../../user_guide/examples/notebooks/ped_quickstart.html">
     PED quickstart
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../user_guide/bibliography.html">
   Bibliography
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../api.html">
   API
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="abtem.waves.html">
     waves
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
    <label for="toctree-checkbox-6">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.waves.BaseWaves.html">
       BaseWaves
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.waves.PlaneWave.html">
       PlaneWave
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.waves.Probe.html">
       Probe
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.waves.Waves.html">
       Waves
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="abtem.scan.html">
     scan
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
    <label for="toctree-checkbox-7">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.scan.BaseScan.html">
       BaseScan
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.scan.CustomScan.html">
       CustomScan
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.scan.GridScan.html">
       GridScan
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.scan.LineScan.html">
       LineScan
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.scan.SourceOffset.html">
       SourceOffset
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="abtem.detectors.html">
     detectors
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
    <label for="toctree-checkbox-8">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.detectors.AnnularDetector.html">
       AnnularDetector
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.detectors.BaseDetector.html">
       BaseDetector
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.detectors.FlexibleAnnularDetector.html">
       FlexibleAnnularDetector
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.detectors.PixelatedDetector.html">
       PixelatedDetector
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.detectors.SegmentedDetector.html">
       SegmentedDetector
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.detectors.WavesDetector.html">
       WavesDetector
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="abtem.measurements.html">
     measurements
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
    <label for="toctree-checkbox-9">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.measurements.BaseMeasurement.html">
       BaseMeasurement
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.measurements.BaseMeasurement2D.html">
       BaseMeasurement2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.measurements.DiffractionPatterns.html">
       DiffractionPatterns
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.measurements.Images.html">
       Images
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.measurements.IndexedDiffractionPatterns.html">
       IndexedDiffractionPatterns
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.measurements.PolarMeasurements.html">
       PolarMeasurements
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.measurements.RealSpaceLineProfiles.html">
       RealSpaceLineProfiles
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.measurements.ReciprocalSpaceLineProfiles.html">
       ReciprocalSpaceLineProfiles
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="abtem.transfer.html">
     transfer
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.cartesian2polar.html">
       cartesian2polar
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.nyquist_sampling.html">
       nyquist_sampling
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.point_resolution.html">
       point_resolution
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.polar2cartesian.html">
       polar2cartesian
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.scherzer_defocus.html">
       scherzer_defocus
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.soft_aperture.html">
       soft_aperture
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.Aberrations.html">
       Aberrations
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.Aperture.html">
       Aperture
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.BaseAperture.html">
       BaseAperture
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.Bullseye.html">
       Bullseye
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.CTF.html">
       CTF
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.SpatialEnvelope.html">
       SpatialEnvelope
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.TemporalEnvelope.html">
       TemporalEnvelope
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.transfer.Vortex.html">
       Vortex
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="abtem.distributions.html">
     distributions
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.distributions.from_values.html">
       from_values
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.distributions.gaussian.html">
       gaussian
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.distributions.uniform.html">
       uniform
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.distributions.BaseDistribution.html">
       BaseDistribution
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="abtem.potentials.iam.html">
     iam
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
    <label for="toctree-checkbox-12">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.potentials.iam.BasePotential.html">
       BasePotential
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.potentials.iam.CrystalPotential.html">
       CrystalPotential
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.potentials.iam.Potential.html">
       Potential
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.potentials.iam.PotentialArray.html">
       PotentialArray
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.potentials.iam.TransmissionFunction.html">
       TransmissionFunction
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="abtem.potentials.charge_density.html">
     charge_density
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
    <label for="toctree-checkbox-13">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.potentials.charge_density.add_point_charges_fourier.html">
       add_point_charges_fourier
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.potentials.charge_density.integrate_gradient_fourier.html">
       integrate_gradient_fourier
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.potentials.charge_density.ChargeDensityPotential.html">
       ChargeDensityPotential
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="abtem.potentials.gpaw.html">
     gpaw
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.potentials.gpaw.get_core_correction_interpolators.html">
       get_core_correction_interpolators
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.potentials.gpaw.integrate_slice.html">
       integrate_slice
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.potentials.gpaw.GPAWParametrization.html">
       GPAWParametrization
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.potentials.gpaw.GPAWPotential.html">
       GPAWPotential
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="abtem.visualize.html">
     visualize
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.visualize.make_toggle_hkl_button.html">
       make_toggle_hkl_button
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.visualize.show_atoms.html">
       show_atoms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.visualize.AxesGrid.html">
       AxesGrid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.visualize.BaseMeasurementVisualization2D.html">
       BaseMeasurementVisualization2D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.visualize.DiffractionSpotsVisualization.html">
       DiffractionSpotsVisualization
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.visualize.MeasurementVisualization.html">
       MeasurementVisualization
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.visualize.MeasurementVisualization1D.html">
       MeasurementVisualization1D
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.visualize.MeasurementVisualization2D.html">
       MeasurementVisualization2D
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="abtem.atoms.html">
     atoms
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
    <label for="toctree-checkbox-16">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.atoms_in_cell.html">
       atoms_in_cell
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.best_orthogonal_cell.html">
       best_orthogonal_cell
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.cut_cell.html">
       cut_cell
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.decompose_affine_transform.html">
       decompose_affine_transform
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.flip_atoms.html">
       flip_atoms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.is_cell_hexagonal.html">
       is_cell_hexagonal
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.is_cell_orthogonal.html">
       is_cell_orthogonal
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.is_cell_valid.html">
       is_cell_valid
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.merge_close_atoms.html">
       merge_close_atoms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.orthogonalize_cell.html">
       orthogonalize_cell
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.pad_atoms.html">
       pad_atoms
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.plane_to_axes.html">
       plane_to_axes
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.pretty_print_transform.html">
       pretty_print_transform
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.rotate_atoms_to_plane.html">
       rotate_atoms_to_plane
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.rotation_matrix_from_plane.html">
       rotation_matrix_from_plane
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.rotation_matrix_to_euler.html">
       rotation_matrix_to_euler
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.shrink_cell.html">
       shrink_cell
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.standardize_cell.html">
       standardize_cell
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.atoms.wrap_with_tolerance.html">
       wrap_with_tolerance
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="abtem.multislice.html">
     multislice
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
    <label for="toctree-checkbox-17">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.multislice.allocate_measurement.html">
       allocate_measurement
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.multislice.allocate_multislice_measurements.html">
       allocate_multislice_measurements
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.multislice.multislice_and_detect.html">
       multislice_and_detect
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.multislice.multislice_step.html">
       multislice_step
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.multislice.transition_potential_multislice_and_detect.html">
       transition_potential_multislice_and_detect
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.multislice.FresnelPropagator.html">
       FresnelPropagator
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="abtem.prism.s_matrix.html">
     s_matrix
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
    <label for="toctree-checkbox-18">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.prism.s_matrix.BaseSMatrix.html">
       BaseSMatrix
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="abtem.prism.s_matrix.SMatrix.html">
       SMatrix
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       SMatrixArray
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="abtem.indexing.html">
     indexing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../config.html">
   Configuration
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  abTEM
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../abtem/contact.html">
   Contact
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../abtem/contribute.html">
   Contribute
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../abtem/cite.html">
   Cite
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../../abtem/changelog.html">
   Changelog
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Freference/api/_autosummary/abtem.prism.s_matrix.SMatrixArray.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/reference/api/_autosummary/abtem.prism.s_matrix.SMatrixArray.rst"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>SMatrixArray</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="smatrixarray">
<h1>SMatrixArray<a class="headerlink" href="#smatrixarray" title="Permalink to this headline">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">abtem.prism.s_matrix.</span></span><span class="sig-name descname"><span class="pre">SMatrixArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semiangle_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_gpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_axes_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abtem.core.array.HasArray</span></code>, <a class="reference internal" href="abtem.prism.s_matrix.BaseSMatrix.html#abtem.prism.s_matrix.BaseSMatrix" title="abtem.prism.s_matrix.BaseSMatrix"><code class="xref py py-class docutils literal notranslate"><span class="pre">abtem.prism.s_matrix.BaseSMatrix</span></code></a></p>
<p>A scattering matrix defined by a given array of dimension 3, where the first indexes the probe plane waves and the
latter two are the <cite>y</cite> and <cite>x</cite> scan directions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>np.ndarray</em>) – Array defining the scattering matrix. Must be 3D or higher, dimensions before the last three dimensions should
represent ensemble dimensions, the next dimension indexes the plane waves and the last two dimensions
represent the spatial extent of the plane waves.</p></li>
<li><p><strong>wave_vectors</strong> (<em>np.ndarray</em>) – Array defining the wave vectors corresponding to each plane wave. Must have shape Nx2, where N is equal to the
number of plane waves.</p></li>
<li><p><strong>semiangle_cutoff</strong> (<em>float</em>) – The radial cutoff of the plane-wave expansion [mrad].</p></li>
<li><p><strong>energy</strong> (<em>float</em>) – Electron energy [eV].</p></li>
<li><p><strong>sampling</strong> (<em>one</em><em> or </em><em>two float</em><em>, </em><em>optional</em>) – Lateral sampling of wave functions [1 / Å]. Provide only if potential is not given. Will be ignored if ‘gpts’
is also provided.</p></li>
<li><p><strong>extent</strong> (<em>one</em><em> or </em><em>two float</em><em>, </em><em>optional</em>) – Lateral extent of wave functions [Å]. Provide only if potential is not given.</p></li>
<li><p><strong>interpolation</strong> (<em>one</em><em> or </em><em>two int</em><em>, </em><em>optional</em>) – Interpolation factor in the <cite>x</cite> and <cite>y</cite> directions (default is 1, ie. no interpolation). If a single value is
provided, assumed to be the same for both directions.</p></li>
<li><p><strong>window_gpts</strong> (<em>tuple of int</em>) – The number of grid points describing the cropping window of the wave functions.</p></li>
<li><p><strong>window_offset</strong> (<em>tuple of int</em>) – The number of grid points from the origin the cropping windows of the wave functions is displaced.</p></li>
<li><p><strong>periodic</strong> (<em>tuple of bool</em>) – </p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – The calculations will be carried out on this device (‘cpu’ or ‘gpu’). Default is ‘cpu’. The default is determined by the user configuration.</p></li>
<li><p><strong>ensemble_axes_metadata</strong> (<em>list of AxesMetadata</em>) – Axis metadata for each ensemble axis. The axis metadata must be compatible with the shape of the array.</p></li>
<li><p><strong>metadata</strong> (<em>dict</em>) – A dictionary defining wave function metadata. All items will be added to the metadata of measurements derived
from the waves.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wave_vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">semiangle_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interpolation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_gpts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(True,</span> <span class="pre">True)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_axes_metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metadata</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.__init__" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.__init__" title="abtem.prism.s_matrix.SMatrixArray.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(array, wave_vectors, semiangle_cutoff)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.apply_transform" title="abtem.prism.s_matrix.SMatrixArray.apply_transform"><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply_transform</span></code></a>(transform[, max_batch])</p></td>
<td><p>Transform the wave functions by a given transformation.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">check_is_compatible</span></code>(other)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.compute" title="abtem.prism.s_matrix.SMatrixArray.compute"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute</span></code></a>([progress_bar, profiler, ...])</p></td>
<td><p>This turns a lazy abTEM object into its in-memory equivalent.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.copy" title="abtem.prism.s_matrix.SMatrixArray.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Make a copy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.copy_to_device" title="abtem.prism.s_matrix.SMatrixArray.copy_to_device"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy_to_device</span></code></a>(device)</p></td>
<td><p>Copy SMatrixArray to specified device.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.dummy_probes" title="abtem.prism.s_matrix.SMatrixArray.dummy_probes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dummy_probes</span></code></a>([scan, ctf, plane])</p></td>
<td><p>A probe or an ensemble of probes equivalent reducing the SMatrix at a single positions, assuming an empty potential.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ensure_lazy</span></code>([chunks])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, bound= HasArray)</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">expand_dims</span></code>([axis, axis_metadata])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, bound= HasArray)</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_array_and_metadata</span></code>(array, ...)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_waves</span></code>(waves, **kwargs)</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.from_zarr" title="abtem.prism.s_matrix.SMatrixArray.from_zarr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">from_zarr</span></code></a>(url[, chunks])</p></td>
<td><p>Read wave functions from a hdf5 file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_items</span></code>(items[, keep_dims])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, bound= HasArray)</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.match_grid" title="abtem.prism.s_matrix.SMatrixArray.match_grid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_grid</span></code></a>(other[, check_match])</p></td>
<td><p>Match the grid to another object with a Grid.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">max</span></code>([axes])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, bound= HasArray)</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mean</span></code>([axes])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, bound= HasArray)</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">min</span></code>([axes])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, bound= HasArray)</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.multislice" title="abtem.prism.s_matrix.SMatrixArray.multislice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multislice</span></code></a>([potential])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">type potential</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="abtem.potentials.iam.BasePotential.html#abtem.potentials.iam.BasePotential" title="abtem.potentials.iam.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a>]</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rechunk</span></code>(chunks[, in_place])</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.reduce" title="abtem.prism.s_matrix.SMatrixArray.reduce"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reduce</span></code></a>([scan, ctf, detectors, ...])</p></td>
<td><p>Scan the probe across the potential and record a measurement for each detector.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.scan" title="abtem.prism.s_matrix.SMatrixArray.scan"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scan</span></code></a>([scan, detectors, ctf, ...])</p></td>
<td><p>Reduce the SMatrix using coefficients calculated by a BaseScan and a CTF, to obtain the exit wave functions at given initial probe positions and aberrations.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_ensemble_axes_metadata</span></code>(axes_metadata, axis)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">squeeze</span></code>([axis])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, bound= HasArray)</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">std</span></code>([axes])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, bound= HasArray)</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sum</span></code>([axes])</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, bound= HasArray)</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_cpu</span></code>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, bound= HasArray)</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_delayed</span></code>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_gpu</span></code>()</p></td>
<td><p><dl class="field-list simple">
<dt class="field-odd">rtype</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, bound= HasArray)</p>
</dd>
</dl>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.to_tiff" title="abtem.prism.s_matrix.SMatrixArray.to_tiff"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_tiff</span></code></a>(filename, **kwargs)</p></td>
<td><p>Write data to a tiff file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.to_zarr" title="abtem.prism.s_matrix.SMatrixArray.to_zarr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_zarr</span></code></a>(url[, compute, overwrite])</p></td>
<td><p>Write data to a zarr file.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">visualize_graph</span></code>(**kwargs)</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.accelerator" title="abtem.prism.s_matrix.SMatrixArray.accelerator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">accelerator</span></code></a></p></td>
<td><p>Accelerator object describing the acceleration energy.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.angular_sampling" title="abtem.prism.s_matrix.SMatrixArray.angular_sampling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">angular_sampling</span></code></a></p></td>
<td><p>Reciprocal-space sampling in units of scattering angles [mrad].</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.antialias_cutoff_gpts" title="abtem.prism.s_matrix.SMatrixArray.antialias_cutoff_gpts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">antialias_cutoff_gpts</span></code></a></p></td>
<td><p>The number of grid points along the x and y direction in the simulation grid at the antialiasing cutoff scattering angle.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.antialias_valid_gpts" title="abtem.prism.s_matrix.SMatrixArray.antialias_valid_gpts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">antialias_valid_gpts</span></code></a></p></td>
<td><p>The number of grid points along the x and y direction in the simulation grid for the largest rectangle that fits within antialiasing cutoff scattering angle.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.axes_metadata" title="abtem.prism.s_matrix.SMatrixArray.axes_metadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">axes_metadata</span></code></a></p></td>
<td><p>List of AxisMetadata.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.base_axes" title="abtem.prism.s_matrix.SMatrixArray.base_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">base_axes</span></code></a></p></td>
<td><p>Axis indices of base axes.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">base_axes_metadata</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">base_shape</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">chunks</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.cutoff_angles" title="abtem.prism.s_matrix.SMatrixArray.cutoff_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cutoff_angles</span></code></a></p></td>
<td><p>Scattering angles at the antialias cutoff [mrad].</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.device" title="abtem.prism.s_matrix.SMatrixArray.device"><code class="xref py py-obj docutils literal notranslate"><span class="pre">device</span></code></a></p></td>
<td><p>The device on which the SMatrixArray is reduced.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dtype</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.energy" title="abtem.prism.s_matrix.SMatrixArray.energy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">energy</span></code></a></p></td>
<td><p>Electron acceleration energy in electron volts.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_axes" title="abtem.prism.s_matrix.SMatrixArray.ensemble_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ensemble_axes</span></code></a></p></td>
<td><p>Axis indices of ensemble axes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_axes_metadata" title="abtem.prism.s_matrix.SMatrixArray.ensemble_axes_metadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ensemble_axes_metadata</span></code></a></p></td>
<td><p>Axis metadata for each ensemble axis.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ensemble_shape</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.extent" title="abtem.prism.s_matrix.SMatrixArray.extent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extent</span></code></a></p></td>
<td><p>Extent of grid for each dimension in Ångstrom.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.full_cutoff_angles" title="abtem.prism.s_matrix.SMatrixArray.full_cutoff_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">full_cutoff_angles</span></code></a></p></td>
<td><p>Scattering angles corresponding to the full wave function size [mrad].</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.gpts" title="abtem.prism.s_matrix.SMatrixArray.gpts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gpts</span></code></a></p></td>
<td><p>Number of grid points for each dimension.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.grid" title="abtem.prism.s_matrix.SMatrixArray.grid"><code class="xref py py-obj docutils literal notranslate"><span class="pre">grid</span></code></a></p></td>
<td><p>Simulation grid.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">interpolation</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_complex</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_lazy</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.metadata" title="abtem.prism.s_matrix.SMatrixArray.metadata"><code class="xref py py-obj docutils literal notranslate"><span class="pre">metadata</span></code></a></p></td>
<td><p>Metadata stored as a dictionary.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.num_axes" title="abtem.prism.s_matrix.SMatrixArray.num_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_axes</span></code></a></p></td>
<td><p>Number of axes.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.num_base_axes" title="abtem.prism.s_matrix.SMatrixArray.num_base_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_base_axes</span></code></a></p></td>
<td><p>Number of base axes.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.num_ensemble_axes" title="abtem.prism.s_matrix.SMatrixArray.num_ensemble_axes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_ensemble_axes</span></code></a></p></td>
<td><p>Number of ensemble axes.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">periodic</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">reciprocal_space_axes_metadata</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.reciprocal_space_sampling" title="abtem.prism.s_matrix.SMatrixArray.reciprocal_space_sampling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reciprocal_space_sampling</span></code></a></p></td>
<td><p>Reciprocal-space sampling in reciprocal Ångstrom.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.rectangle_cutoff_angles" title="abtem.prism.s_matrix.SMatrixArray.rectangle_cutoff_angles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">rectangle_cutoff_angles</span></code></a></p></td>
<td><p>Scattering angles corresponding to the sides of the largest rectangle within the antialias cutoff [mrad].</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.sampling" title="abtem.prism.s_matrix.SMatrixArray.sampling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sampling</span></code></a></p></td>
<td><p>Grid sampling for each dimension in Ångstrom per grid point.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.semiangle_cutoff" title="abtem.prism.s_matrix.SMatrixArray.semiangle_cutoff"><code class="xref py py-obj docutils literal notranslate"><span class="pre">semiangle_cutoff</span></code></a></p></td>
<td><p>The cutoff semiangle of the plane wave expansion.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.shape" title="abtem.prism.s_matrix.SMatrixArray.shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shape</span></code></a></p></td>
<td><p>The size of each axis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.storage_device" title="abtem.prism.s_matrix.SMatrixArray.storage_device"><code class="xref py py-obj docutils literal notranslate"><span class="pre">storage_device</span></code></a></p></td>
<td><p>The device on which the SMatrixArray is stored.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">wave_vectors</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.wavelength" title="abtem.prism.s_matrix.SMatrixArray.wavelength"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wavelength</span></code></a></p></td>
<td><p>Relativistic wavelength in Ångstrom.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.waves" title="abtem.prism.s_matrix.SMatrixArray.waves"><code class="xref py py-obj docutils literal notranslate"><span class="pre">waves</span></code></a></p></td>
<td><p>The wave vectors describing each plane wave.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.window_extent" title="abtem.prism.s_matrix.SMatrixArray.window_extent"><code class="xref py py-obj docutils literal notranslate"><span class="pre">window_extent</span></code></a></p></td>
<td><p>The cropping window extent of the wave functions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.window_gpts" title="abtem.prism.s_matrix.SMatrixArray.window_gpts"><code class="xref py py-obj docutils literal notranslate"><span class="pre">window_gpts</span></code></a></p></td>
<td><p>The number of grid points describing the cropping window of the wave functions.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray.window_offset" title="abtem.prism.s_matrix.SMatrixArray.window_offset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">window_offset</span></code></a></p></td>
<td><p>The number of grid points from the origin the cropping windows of the wave functions is displaced.</p></td>
</tr>
</tbody>
</table>
<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.accelerator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">accelerator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">abtem.core.energy.Accelerator</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.accelerator" title="Permalink to this definition">#</a></dt>
<dd><p>Accelerator object describing the acceleration energy.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.angular_sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">angular_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.angular_sampling" title="Permalink to this definition">#</a></dt>
<dd><p>Reciprocal-space sampling in units of scattering angles [mrad].</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.antialias_cutoff_gpts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">antialias_cutoff_gpts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.antialias_cutoff_gpts" title="Permalink to this definition">#</a></dt>
<dd><p>The number of grid points along the x and y direction in the simulation grid at the antialiasing cutoff
scattering angle.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.antialias_valid_gpts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">antialias_valid_gpts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.antialias_valid_gpts" title="Permalink to this definition">#</a></dt>
<dd><p>The number of grid points along the x and y direction in the simulation grid for the largest rectangle that fits
within antialiasing cutoff scattering angle.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.apply_transform">
<span class="sig-name descname"><span class="pre">apply_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.apply_transform" title="Permalink to this definition">#</a></dt>
<dd><p>Transform the wave functions by a given transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transform</strong> (<em>WaveTransform</em>) – The wave-function transformation to apply.</p></li>
<li><p><strong>max_batch</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of wave functions in each chunk of the Dask array. If ‘auto’ (default), the batch size is
automatically chosen based on the abtem user configuration settings “dask.chunk-size” and
“dask.chunk-size-gpu”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>transformed_waves</strong> – The transformed waves.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="abtem.waves.Waves.html#abtem.waves.Waves" title="abtem.waves.Waves">Waves</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.axes_metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">axes_metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">abtem.core.axes.AxesMetadataList</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.axes_metadata" title="Permalink to this definition">#</a></dt>
<dd><p>List of AxisMetadata.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.base_axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">base_axes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.base_axes" title="Permalink to this definition">#</a></dt>
<dd><p>Axis indices of base axes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profiler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resource_profiler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.compute" title="Permalink to this definition">#</a></dt>
<dd><p>This turns a lazy abTEM object into its in-memory equivalent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>progress_bar</strong> (<em>bool</em>) – Display a progress bar in the terminal or notebook during computation. The progress bar is only displayed
with a local scheduler.</p></li>
<li><p><strong>profiler</strong> (<em>bool</em>) – Return Profiler class used to profile Dask’s execution at the task level. Only execution with a local
is profiled.</p></li>
<li><p><strong>resource_profiler</strong> (<em>bool</em>) – Return ResourceProfiler class is used to profile Dask’s execution at the resource level.</p></li>
<li><p><strong>kwargs</strong> – Additional keyword arguments passes to <cite>dask.compute</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.copy">
<span class="sig-name descname"><span class="pre">copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.copy" title="Permalink to this definition">#</a></dt>
<dd><p>Make a copy.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.copy_to_device">
<span class="sig-name descname"><span class="pre">copy_to_device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray.copy_to_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.copy_to_device" title="Permalink to this definition">#</a></dt>
<dd><p>Copy SMatrixArray to specified device.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray" title="abtem.prism.s_matrix.SMatrixArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">SMatrixArray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.cutoff_angles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cutoff_angles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.cutoff_angles" title="Permalink to this definition">#</a></dt>
<dd><p>Scattering angles at the antialias cutoff [mrad].</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.device" title="Permalink to this definition">#</a></dt>
<dd><p>The device on which the SMatrixArray is reduced.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.dummy_probes">
<span class="sig-name descname"><span class="pre">dummy_probes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'entrance'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.dummy_probes" title="Permalink to this definition">#</a></dt>
<dd><p>A probe or an ensemble of probes equivalent reducing the SMatrix at a single positions, assuming an empty
potential.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scan</strong> (<a class="reference internal" href="abtem.scan.BaseScan.html#abtem.scan.BaseScan" title="abtem.scan.BaseScan"><em>BaseScan</em></a>) – </p></li>
<li><p><strong>ctf</strong> (<a class="reference internal" href="abtem.transfer.CTF.html#abtem.transfer.CTF" title="abtem.transfer.CTF"><em>CTF</em></a>) – </p></li>
<li><p><strong>plane</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>dummy_probes</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Probes</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy</span></span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.energy" title="Permalink to this definition">#</a></dt>
<dd><p>Electron acceleration energy in electron volts.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.ensemble_axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ensemble_axes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_axes" title="Permalink to this definition">#</a></dt>
<dd><p>Axis indices of ensemble axes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.ensemble_axes_metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ensemble_axes_metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">abtem.core.axes.AxisMetadata</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.ensemble_axes_metadata" title="Permalink to this definition">#</a></dt>
<dd><p>Axis metadata for each ensemble axis.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.extent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">extent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.extent" title="Permalink to this definition">#</a></dt>
<dd><p>Extent of grid for each dimension in Ångstrom.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.from_zarr">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_zarr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.from_zarr" title="Permalink to this definition">#</a></dt>
<dd><p>Read wave functions from a hdf5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeVar</span></code>(<code class="docutils literal notranslate"><span class="pre">T</span></code>, bound= HasArray)</p>
</dd>
</dl>
<dl class="simple">
<dt>url<span class="classifier">str</span></dt><dd><p>Location of the data, typically a path to a local file. A URL can also include a protocol specifier like
s3:// for remote data.</p>
</dd>
<dt>chunks<span class="classifier">int, optional</span></dt><dd><p>aaaa</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.full_cutoff_angles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">full_cutoff_angles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.full_cutoff_angles" title="Permalink to this definition">#</a></dt>
<dd><p>Scattering angles corresponding to the full wave function size [mrad].</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.gpts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gpts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.gpts" title="Permalink to this definition">#</a></dt>
<dd><p>Number of grid points for each dimension.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.grid">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">grid</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">abtem.core.grid.Grid</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.grid" title="Permalink to this definition">#</a></dt>
<dd><p>Simulation grid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.match_grid">
<span class="sig-name descname"><span class="pre">match_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.match_grid" title="Permalink to this definition">#</a></dt>
<dd><p>Match the grid to another object with a Grid.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.metadata">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">metadata</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.metadata" title="Permalink to this definition">#</a></dt>
<dd><p>Metadata stored as a dictionary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.multislice">
<span class="sig-name descname"><span class="pre">multislice</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">potential</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray.multislice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.multislice" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>potential</strong> (<code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<a class="reference internal" href="abtem.potentials.iam.BasePotential.html#abtem.potentials.iam.BasePotential" title="abtem.potentials.iam.BasePotential"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePotential</span></code></a>]) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#abtem.prism.s_matrix.SMatrixArray" title="abtem.prism.s_matrix.SMatrixArray"><code class="xref py py-class docutils literal notranslate"><span class="pre">SMatrixArray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.num_axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_axes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.num_axes" title="Permalink to this definition">#</a></dt>
<dd><p>Number of axes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.num_base_axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_base_axes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.num_base_axes" title="Permalink to this definition">#</a></dt>
<dd><p>Number of base axes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.num_ensemble_axes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_ensemble_axes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.num_ensemble_axes" title="Permalink to this definition">#</a></dt>
<dd><p>Number of ensemble axes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.reciprocal_space_sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reciprocal_space_sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.reciprocal_space_sampling" title="Permalink to this definition">#</a></dt>
<dd><p>Reciprocal-space sampling in reciprocal Ångstrom.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.rectangle_cutoff_angles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rectangle_cutoff_angles</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.rectangle_cutoff_angles" title="Permalink to this definition">#</a></dt>
<dd><p>Scattering angles corresponding to the sides of the largest rectangle within the antialias cutoff [mrad].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.reduce">
<span class="sig-name descname"><span class="pre">reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_scheme</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray.reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.reduce" title="Permalink to this definition">#</a></dt>
<dd><p>Scan the probe across the potential and record a measurement for each detector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>detectors</strong> (<em>List of Detector objects</em>) – The detectors recording the measurements.</p></li>
<li><p><strong>scan</strong> (<em>Scan object</em>) – Scan defining the positions of the probe wave functions.</p></li>
<li><p><strong>ctf</strong> (<em>CTF object</em><em>, </em><em>optional</em>) – The probe contrast transfer function. Default is None (aperture is set by the planewave cutoff).</p></li>
<li><p><strong>max_batch_reduction</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Number of positions per reduction operation. A large number of positions better utilize thread
parallelization, but requires more memory and floating point operations. If ‘auto’ (default), the batch size
is automatically chosen based on the abtem user configuration settings “dask.chunk-size” and
“dask.chunk-size-gpu”.</p></li>
<li><p><strong>rechunk</strong> (<em>two int</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Partitioning of the scan. The scattering matrix will be reduced in similarly partitioned chunks.
Should be equal to or greater than the interpolation.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="abtem.measurements.BaseMeasurement.html#abtem.measurements.BaseMeasurement" title="abtem.measurements.BaseMeasurement"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMeasurement</span></code></a>, <a class="reference internal" href="abtem.waves.Waves.html#abtem.waves.Waves" title="abtem.waves.Waves"><code class="xref py py-class docutils literal notranslate"><span class="pre">Waves</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code>[<a class="reference internal" href="abtem.measurements.BaseMeasurement.html#abtem.measurements.BaseMeasurement" title="abtem.measurements.BaseMeasurement"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMeasurement</span></code></a>, <a class="reference internal" href="abtem.waves.Waves.html#abtem.waves.Waves" title="abtem.waves.Waves"><code class="xref py py-class docutils literal notranslate"><span class="pre">Waves</span></code></a>]]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.sampling">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sampling</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.sampling" title="Permalink to this definition">#</a></dt>
<dd><p>Grid sampling for each dimension in Ångstrom per grid point.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.scan">
<span class="sig-name descname"><span class="pre">scan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ctf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_batch_reduction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rechunk</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/abtem/prism/s_matrix.html#SMatrixArray.scan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.scan" title="Permalink to this definition">#</a></dt>
<dd><p>Reduce the SMatrix using coefficients calculated by a BaseScan and a CTF, to obtain the exit wave functions
at given initial probe positions and aberrations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scan</strong> (<a class="reference internal" href="abtem.scan.BaseScan.html#abtem.scan.BaseScan" title="abtem.scan.BaseScan"><em>BaseScan</em></a>) – Positions of the probe wave functions. If not given, scans across the entire potential at Nyquist sampling.</p></li>
<li><p><strong>detectors</strong> (<a class="reference internal" href="abtem.detectors.BaseDetector.html#abtem.detectors.BaseDetector" title="abtem.detectors.BaseDetector"><em>BaseDetector</em></a><em>, </em><em>list of BaseDetector</em><em>, </em><em>optional</em>) – A detector or a list of detectors defining how the wave functions should be converted to measurements after
running the multislice algorithm. See abtem.measurements.detect for a list of implemented detectors.</p></li>
<li><p><strong>ctf</strong> (<a class="reference internal" href="abtem.transfer.CTF.html#abtem.transfer.CTF" title="abtem.transfer.CTF"><em>CTF</em></a>) – Contrast transfer function from used for calculating the expansion coefficients in the reduction of the
SMatrix.</p></li>
<li><p><strong>max_batch_reduction</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Number of positions per reduction operation. A large number of positions better utilize thread
parallelization, but requires more memory and floating point operations. If ‘auto’ (default), the batch size
is automatically chosen based on the abtem user configuration settings “dask.chunk-size” and
“dask.chunk-size-gpu”.</p></li>
<li><p><strong>rechunk</strong> (<em>str</em><em> or </em><em>tuple of int</em><em>, </em><em>optional</em>) – Parallel reduction of the SMatrix requires rechunking the Dask array from chunking along the expansion axis
to chunking over the spatial axes. If given as a tuple of int of length the SMatrix is rechunked to have
those chunks. If ‘auto’ (default) the chunks are taken to be identical to the interpolation factor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>detected_waves</strong> (<em>BaseMeasurement or list of BaseMeasurement</em>) – The detected measurement (if detector(s) given).</p></li>
<li><p><strong>exit_waves</strong> (<em>Waves</em>) – Wave functions at the exit plane(s) of the potential (if no detector(s) given).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.semiangle_cutoff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">semiangle_cutoff</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">float</span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.semiangle_cutoff" title="Permalink to this definition">#</a></dt>
<dd><p>The cutoff semiangle of the plane wave expansion.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.shape" title="Permalink to this definition">#</a></dt>
<dd><p>The size of each axis.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.storage_device">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">storage_device</span></span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.storage_device" title="Permalink to this definition">#</a></dt>
<dd><p>The device on which the SMatrixArray is stored.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.to_tiff">
<span class="sig-name descname"><span class="pre">to_tiff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.to_tiff" title="Permalink to this definition">#</a></dt>
<dd><p>Write data to a tiff file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – The filename of the file to write.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to tifffile.imwrite.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.to_zarr">
<span class="sig-name descname"><span class="pre">to_zarr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.to_zarr" title="Permalink to this definition">#</a></dt>
<dd><p>Write data to a zarr file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – Location of the data, typically a path to a local file. A URL can also include a protocol specifier like
s3:// for remote data.</p></li>
<li><p><strong>compute</strong> (<em>bool</em>) – If true compute immediately; return dask.delayed.Delayed otherwise.</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – If given array already exists, overwrite=False will cause an error, where overwrite=True will replace the
existing data.</p></li>
<li><p><strong>kwargs</strong> – Keyword arguments passed to dask.array.to_zarr.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.wavelength">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wavelength</span></span><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.wavelength" title="Permalink to this definition">#</a></dt>
<dd><p>Relativistic wavelength in Ångstrom.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.waves">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">waves</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="abtem.waves.Waves.html#abtem.waves.Waves" title="abtem.waves.Waves"><span class="pre">abtem.waves.Waves</span></a></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.waves" title="Permalink to this definition">#</a></dt>
<dd><p>The wave vectors describing each plane wave.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.window_extent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">window_extent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.window_extent" title="Permalink to this definition">#</a></dt>
<dd><p>The cropping window extent of the wave functions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.window_gpts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">window_gpts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.window_gpts" title="Permalink to this definition">#</a></dt>
<dd><p>The number of grid points describing the cropping window of the wave functions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="abtem.prism.s_matrix.SMatrixArray.window_offset">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">window_offset</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#abtem.prism.s_matrix.SMatrixArray.window_offset" title="Permalink to this definition">#</a></dt>
<dd><p>The number of grid points from the origin the cropping windows of the wave functions is displaced.</p>
</dd></dl>

</dd></dl>

</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./reference\api\_autosummary"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="abtem.prism.s_matrix.SMatrix.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">SMatrix</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="abtem.indexing.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">indexing</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By abTEM developers<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>